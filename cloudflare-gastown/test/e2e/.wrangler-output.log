[33mâ–² [43;33m[[43;30mWARNING[43;33m][0m [1mUnrecognised WRANGLER_LOG value "/users/john/projects/professional/kilo/cloud/cloudflare-gastown/test/e2e/.wrangler-output.log", expected "none" | "error" | "warn" | "info" | "log" | "debug", defaulting to "log"...[0m



 â›…ï¸ wrangler 4.61.1 (update available 4.67.0)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Your Worker has access to the following bindings:
Binding                                                                                Resource                  Mode
env.GASTOWN_USER (GastownUserDO)                                                       Durable Object            local
env.AGENT_IDENTITY (AgentIdentityDO)                                                   Durable Object            local
env.TOWN (TownDO)                                                                      Durable Object            local
env.TOWN_CONTAINER (TownContainerDO)                                                   Durable Object            local
env.AGENT (AgentDO)                                                                    Durable Object            local
env.GASTOWN_JWT_SECRET (342a86d9e3a94da698e82d0c6e2a36f0/GASTOWN_JWT_SECRET_PROD)      Secrets Store Secret      local
env.ENVIRONMENT ("development")                                                        Environment Variable      local
env.CF_ACCESS_TEAM ("engineering-e11")                                                 Environment Variable      local
env.CF_ACCESS_AUD ("f30e3fd893df52fa3ffc50fbdb5ee6a4f1116...")                         Environment Variable      local
env.KILO_API_URL ("http://host.docker.internal:3000")                                  Environment Variable      local
env.GASTOWN_API_URL ("(hidden)")                                                       Environment Variable      local

The following containers are available:
- gastown-dev-TownContainerDO (/Users/john/projects/professional/kilo/cloud/cloudflare-gastown/container/Dockerfile.dev)

âŽ” Preparing container image(s)...
#0 building with "desktop-linux" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 2.49kB done
#1 WARN: FromPlatformFlagConstDisallowed: FROM --platform flag should not use constant value "linux/arm64" (line 1)
#1 DONE 0.0s

#2 [auth] oven/bun:pull token for registry-1.docker.io
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/oven/bun:1-slim
#3 DONE 0.5s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 758B done
#5 DONE 0.0s

#6 [ 1/10] FROM docker.io/oven/bun:1-slim@sha256:8ca06c7812d9050ccc4b80799685f395d6a0d051d3b7207dfd120e2b437b1ec9
#6 resolve docker.io/oven/bun:1-slim@sha256:8ca06c7812d9050ccc4b80799685f395d6a0d051d3b7207dfd120e2b437b1ec9 done
#6 DONE 0.0s

#7 [ 5/10] COPY plugin/ /opt/gastown-plugin/
#7 CACHED

#8 [ 6/10] RUN cd /opt/gastown-plugin && npm install --omit=dev &&     mkdir -p /root/.config/kilo/plugins &&     ln -s /opt/gastown-plugin/index.ts /root/.config/kilo/plugins/gastown.ts
#8 CACHED

#9 [ 2/10] RUN apt-get update &&     apt-get install -y --no-install-recommends git curl ca-certificates &&     curl -fsSL https://deb.nodesource.com/setup_22.x | bash - &&     apt-get install -y --no-install-recommends nodejs &&     curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg       -o /usr/share/keyrings/githubcli-archive-keyring.gpg &&     echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main"       > /etc/apt/sources.list.d/github-cli.list &&     apt-get update &&     apt-get install -y --no-install-recommends gh &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*
#9 CACHED

#10 [ 3/10] RUN npm install -g @kilocode/cli @kilocode/cli-linux-arm64 @kilocode/cli-linux-arm64-musl &&     ln -s "$(which kilo)" /usr/local/bin/opencode
#10 CACHED

#11 [ 8/10] COPY package.json bun.lock ./
#11 CACHED

#12 [ 7/10] WORKDIR /app
#12 CACHED

#13 [ 9/10] RUN bun install --frozen-lockfile --production
#13 CACHED

#14 [ 4/10] RUN mkdir -p /workspace/rigs /app
#14 CACHED

#15 [10/10] COPY src/ ./src/
#15 CACHED

#16 exporting to image
#16 exporting layers done
#16 exporting manifest sha256:bcad916ec51bca9d5768ca9232391b9ab472bdd58a6cbbfecf748a270d212000 done
#16 exporting config sha256:f2184455b9487538f6fa32d252f47a9f275317723de00ec63189922081288bc8 done
#16 naming to docker.io/cloudflare-dev/towncontainerdo:cace7405 done
#16 DONE 0.0s

 [33m1 warning found (use docker --debug to expand):
[0m - FromPlatformFlagConstDisallowed: FROM --platform flag should not use constant value "linux/arm64" (line 1)
âŽ” Container image(s) ready
âŽ” Starting local server...
[wrangler:info] Ready on http://localhost:9787
[gastown-worker] --> GET /health
[gastown-worker] <-- GET /health 200 (0ms)
[wrangler:info] GET /health 200 OK (1279ms)
[gastown-worker] --> GET /health
[gastown-worker] <-- GET /health 200 (0ms)
[wrangler:info] GET /health 200 OK (1ms)
[gastown-worker] --> GET /nonexistent
[gastown-worker] <-- GET /nonexistent 404 (0ms)
[wrangler:info] GET /nonexistent 404 Not Found (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738618-10652/towns
[GastownUser.do] createTown: id=01cf283f-3a99-496b-be42-c06122d38e45 name=E2E-Town owner=e2e-user-1771738618-10652
[GastownUser.do] createTown: created town id=01cf283f-3a99-496b-be42-c06122d38e45
[gastown-worker] <-- POST /api/users/e2e-user-1771738618-10652/towns 201 (3ms)
[wrangler:info] POST /api/users/e2e-user-1771738618-10652/towns 201 Created (4ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738618-10652/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771738618-10652/towns 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771738618-10652/towns 200 OK (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738618-10652/towns/01cf283f-3a99-496b-be42-c06122d38e45
[gastown-worker] <-- GET /api/users/e2e-user-1771738618-10652/towns/01cf283f-3a99-496b-be42-c06122d38e45 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771738618-10652/towns/01cf283f-3a99-496b-be42-c06122d38e45 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738618-17863/towns
[GastownUser.do] createTown: id=ae37b6f9-5673-423c-8a7a-796cbf0a9316 name=Token-Town owner=e2e-user-1771738618-17863
[GastownUser.do] createTown: created town id=ae37b6f9-5673-423c-8a7a-796cbf0a9316
[gastown-worker] <-- POST /api/users/e2e-user-1771738618-17863/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738618-17863/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738618-17863/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738618-17863 town_id=ae37b6f9-5673-423c-8a7a-796cbf0a9316 name=token-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=ae37b6f9-5673-423c-8a7a-796cbf0a9316 name=token-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=950a63d9-8622-45b1-92f4-bd964746b988
[towns.handler] handleCreateRig: rig created id=950a63d9-8622-45b1-92f4-bd964746b988, now configuring Rig DO
[Town.do] configureRig: rigId=950a63d9-8622-45b1-92f4-bd964746b988 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=test-kil... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=de7431ffc9301f2094cd1a65e6929957d943e8ac0cc5c90983d8a94253877505
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738618-17863/rigs 201 (332ms)
[wrangler:info] POST /api/users/e2e-user-1771738618-17863/rigs 201 Created (332ms)
[gastown-worker] --> GET /api/towns/ae37b6f9-5673-423c-8a7a-796cbf0a9316/config
[gastown-worker] <-- GET /api/towns/ae37b6f9-5673-423c-8a7a-796cbf0a9316/config 200 (0ms)
[wrangler:info] GET /api/towns/ae37b6f9-5673-423c-8a7a-796cbf0a9316/config 200 OK (1ms)
[gastown-worker] --> GET /api/towns/ae37b6f9-5673-423c-8a7a-796cbf0a9316/mayor/status
[gastown-worker] <-- GET /api/towns/ae37b6f9-5673-423c-8a7a-796cbf0a9316/mayor/status 200 (1ms)
[wrangler:info] GET /api/towns/ae37b6f9-5673-423c-8a7a-796cbf0a9316/mayor/status 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738620-17805/towns
[GastownUser.do] createTown: id=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd name=Mayor-Token-Town owner=e2e-user-1771738620-17805
[GastownUser.do] createTown: created town id=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd
[gastown-worker] <-- POST /api/users/e2e-user-1771738620-17805/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738620-17805/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738620-17805/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738620-17805 town_id=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd name=mayor-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd name=mayor-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=ec2437c1-9b43-4626-b0e5-a1286a15af32
[towns.handler] handleCreateRig: rig created id=ec2437c1-9b43-4626-b0e5-a1286a15af32, now configuring Rig DO
[Town.do] configureRig: rigId=ec2437c1-9b43-4626-b0e5-a1286a15af32 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-kilo... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=3ff00f29e9b6c26347b0c7fb22117c529471b76ee6adf2f633f7f15a729f7695
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738620-17805/rigs 201 (329ms)
[wrangler:info] POST /api/users/e2e-user-1771738620-17805/rigs 201 Created (330ms)
[gastown-worker] --> GET /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/config
[gastown-worker] <-- GET /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/config 200 (0ms)
[wrangler:info] GET /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/config 200 OK (1ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/mayor/message
[mayor.handler] handleSendMayorMessage: townId=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd message="Hello from E2E test"
[Town.do] sendMayorMessage: townId=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd mayorId=f3142611-3892-4b73-8e9a-f826a90c9a36 containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-kilo... stored
[Town.do] startAgentInContainer: agentId=f3142611-3892-4b73-8e9a-f826a90c9a36 role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (3ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/mayor/message 200 (5706ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/mayor/message 200 OK (5706ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (6ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (5ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738631-26776/towns
[GastownUser.do] createTown: id=7275b441-0abb-4b10-a04e-e4edbbb389d7 name=Single-Container-Town owner=e2e-user-1771738631-26776
[GastownUser.do] createTown: created town id=7275b441-0abb-4b10-a04e-e4edbbb389d7
[gastown-worker] <-- POST /api/users/e2e-user-1771738631-26776/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738631-26776/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738631-26776/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738631-26776 town_id=7275b441-0abb-4b10-a04e-e4edbbb389d7 name=single-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=7275b441-0abb-4b10-a04e-e4edbbb389d7 name=single-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=ff417521-7e5c-472c-aa2e-0a1f81de910e
[towns.handler] handleCreateRig: rig created id=ff417521-7e5c-472c-aa2e-0a1f81de910e, now configuring Rig DO
[Town.do] configureRig: rigId=ff417521-7e5c-472c-aa2e-0a1f81de910e hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-kilo... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=98d3c6a15dd2f2b129d26e0c395f093d8a29820b2a98b6ec0af5b8472dbc0012
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738631-26776/rigs 201 (328ms)
[wrangler:info] POST /api/users/e2e-user-1771738631-26776/rigs 201 Created (331ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/mayor/message
[mayor.handler] handleSendMayorMessage: townId=7275b441-0abb-4b10-a04e-e4edbbb389d7 message="Test single container"
[Town.do] sendMayorMessage: townId=7275b441-0abb-4b10-a04e-e4edbbb389d7 mayorId=de32f258-0309-44bc-8795-7c5fd44b129e containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=7275b441-0abb-4b10-a04e-e4edbbb389d7 hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-kilo... stored
[Town.do] startAgentInContainer: agentId=de32f258-0309-44bc-8795-7c5fd44b129e role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[Town.do] alarm: fired for town=ae37b6f9-5673-423c-8a7a-796cbf0a9316
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (4ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (4ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (1ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/mayor/message 200 (5522ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/mayor/message 200 OK (5524ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (5ms)
[Town.do] alarm: fired for town=7275b441-0abb-4b10-a04e-e4edbbb389d7
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/mayor/message
[mayor.handler] handleSendMayorMessage: townId=7275b441-0abb-4b10-a04e-e4edbbb389d7 message="Second message"
[Town.do] sendMayorMessage: townId=7275b441-0abb-4b10-a04e-e4edbbb389d7 mayorId=de32f258-0309-44bc-8795-7c5fd44b129e containerStatus=running isAlive=true
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (0ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (4ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (1ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (0ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/mayor/message 200 (327ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/mayor/message 200 OK (329ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (2ms)
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (4ms)
[Town.do] alarm: fired for town=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/users/e2e-user-1771738652-2920/towns
[GastownUser.do] createTown: id=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4 name=Mayor-Status-Town owner=e2e-user-1771738652-2920
[GastownUser.do] createTown: created town id=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4
[gastown-worker] <-- POST /api/users/e2e-user-1771738652-2920/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738652-2920/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738652-2920/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738652-2920 town_id=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4 name=status-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4 name=status-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=995abcc5-483e-40d3-9aef-578a2856e02e
[towns.handler] handleCreateRig: rig created id=995abcc5-483e-40d3-9aef-578a2856e02e, now configuring Rig DO
[Town.do] configureRig: rigId=995abcc5-483e-40d3-9aef-578a2856e02e hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-kilo... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738652-2920/rigs 201 (326ms)
[wrangler:info] POST /api/users/e2e-user-1771738652-2920/rigs 201 Created (327ms)
[gastown-worker] --> GET /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/status
[gastown-worker] <-- GET /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/status 200 (0ms)
[wrangler:info] GET /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/status 200 OK (1ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/message
[mayor.handler] handleSendMayorMessage: townId=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4 message="Status test"
[Town.do] sendMayorMessage: townId=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4 mayorId=a54c4baa-e6d0-42ca-8808-971983c8f80f containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4 hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-kilo... stored
[Town.do] startAgentInContainer: agentId=a54c4baa-e6d0-42ca-8808-971983c8f80f role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[gastown-worker] --> POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events
[gastown-worker] <-- POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/rigs/mayor-f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (3ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (0ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/message 200 (5525ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/message 200 OK (5528ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] --> POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/rigs/mayor-1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/agent-events 201 Created (5ms)
[gastown-worker] --> GET /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/status
[gastown-worker] <-- GET /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/status 200 (0ms)
[wrangler:info] GET /api/towns/1dffa8d5-5ca7-423f-9630-c4c15bf2aab4/mayor/status 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738660-3713/towns
[GastownUser.do] createTown: id=0566798f-2acb-4335-b469-f231d73bd518 name=List-Rigs-Town owner=e2e-user-1771738660-3713
[GastownUser.do] createTown: created town id=0566798f-2acb-4335-b469-f231d73bd518
[gastown-worker] <-- POST /api/users/e2e-user-1771738660-3713/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738660-3713/towns 201 Created (3ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738660-3713/towns/0566798f-2acb-4335-b469-f231d73bd518/rigs
[gastown-worker] <-- GET /api/users/e2e-user-1771738660-3713/towns/0566798f-2acb-4335-b469-f231d73bd518/rigs 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771738660-3713/towns/0566798f-2acb-4335-b469-f231d73bd518/rigs 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738660-3713/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738660-3713 town_id=0566798f-2acb-4335-b469-f231d73bd518 name=rig-a git_url=https://github.com/a/a.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=0566798f-2acb-4335-b469-f231d73bd518 name=rig-a git_url=https://github.com/a/a.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=5e119040-4263-4dbd-9613-1d29f1c1bf03
[towns.handler] handleCreateRig: rig created id=5e119040-4263-4dbd-9613-1d29f1c1bf03, now configuring Rig DO
[Town.do] configureRig: rigId=5e119040-4263-4dbd-9613-1d29f1c1bf03 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=dfc8fcf65a83aa8c3b805c2ff685550ba2cfbcea5f961016af430b30a129866d
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738660-3713/rigs 201 (326ms)
[wrangler:info] POST /api/users/e2e-user-1771738660-3713/rigs 201 Created (327ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738660-3713/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738660-3713 town_id=0566798f-2acb-4335-b469-f231d73bd518 name=rig-b git_url=https://github.com/b/b.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=0566798f-2acb-4335-b469-f231d73bd518 name=rig-b git_url=https://github.com/b/b.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=650f4cfa-01ea-48f7-8513-385693fa7a7a
[towns.handler] handleCreateRig: rig created id=650f4cfa-01ea-48f7-8513-385693fa7a7a, now configuring Rig DO
[Town.do] configureRig: rigId=650f4cfa-01ea-48f7-8513-385693fa7a7a hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738660-3713/rigs 201 (5ms)
[wrangler:info] POST /api/users/e2e-user-1771738660-3713/rigs 201 Created (5ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738660-3713/towns/0566798f-2acb-4335-b469-f231d73bd518/rigs
[gastown-worker] <-- GET /api/users/e2e-user-1771738660-3713/towns/0566798f-2acb-4335-b469-f231d73bd518/rigs 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771738660-3713/towns/0566798f-2acb-4335-b469-f231d73bd518/rigs 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738661-6381/towns
[GastownUser.do] createTown: id=25637c22-aaf3-4e87-860e-957da3d59f35 name=Config-Town owner=e2e-user-1771738661-6381
[GastownUser.do] createTown: created town id=25637c22-aaf3-4e87-860e-957da3d59f35
[gastown-worker] <-- POST /api/users/e2e-user-1771738661-6381/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738661-6381/towns 201 Created (2ms)
[gastown-worker] --> GET /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config
[gastown-worker] <-- GET /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config 200 (2ms)
[wrangler:info] GET /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config 200 OK (2ms)
[gastown-worker] --> PATCH /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config
[Town.do] updateTownConfig: saved config with 1 env vars
[town-config.handler] handleUpdateTownConfig: town=25637c22-aaf3-4e87-860e-957da3d59f35 updated config
[gastown-worker] <-- PATCH /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config 200 (1ms)
[wrangler:info] PATCH /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config 200 OK (2ms)
[gastown-worker] --> GET /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config
[gastown-worker] <-- GET /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config 200 (0ms)
[wrangler:info] GET /api/towns/25637c22-aaf3-4e87-860e-957da3d59f35/config 200 OK (1ms)
[Town.do] alarm: fired for town=7275b441-0abb-4b10-a04e-e4edbbb389d7
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/users/e2e-user-1771738661-10866/towns
[GastownUser.do] createTown: id=56f7e4b7-5b0a-4507-9f98-2a619fd5d059 name=Delete-Town owner=e2e-user-1771738661-10866
[GastownUser.do] createTown: created town id=56f7e4b7-5b0a-4507-9f98-2a619fd5d059
[gastown-worker] <-- POST /api/users/e2e-user-1771738661-10866/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738661-10866/towns 201 Created (2ms)
[gastown-worker] --> DELETE /api/users/e2e-user-1771738661-10866/towns/56f7e4b7-5b0a-4507-9f98-2a619fd5d059
[Town.do] destroy: clearing all storage and alarms
[towns.handler] handleDeleteTown: Town DO destroyed for town 56f7e4b7-5b0a-4507-9f98-2a619fd5d059
[gastown-worker] <-- DELETE /api/users/e2e-user-1771738661-10866/towns/56f7e4b7-5b0a-4507-9f98-2a619fd5d059 200 (4ms)
[wrangler:info] DELETE /api/users/e2e-user-1771738661-10866/towns/56f7e4b7-5b0a-4507-9f98-2a619fd5d059 200 OK (4ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738661-10866/towns/56f7e4b7-5b0a-4507-9f98-2a619fd5d059
[gastown-worker] <-- GET /api/users/e2e-user-1771738661-10866/towns/56f7e4b7-5b0a-4507-9f98-2a619fd5d059 404 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771738661-10866/towns/56f7e4b7-5b0a-4507-9f98-2a619fd5d059 404 Not Found (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738661-10866/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771738661-10866/towns 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771738661-10866/towns 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738661-4447/towns
[GastownUser.do] createTown: id=6fe469fe-155d-46c5-bc49-f98f1bbd6181 name=Del-Rig-Town owner=e2e-user-1771738661-4447
[GastownUser.do] createTown: created town id=6fe469fe-155d-46c5-bc49-f98f1bbd6181
[gastown-worker] <-- POST /api/users/e2e-user-1771738661-4447/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738661-4447/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738661-4447/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738661-4447 town_id=6fe469fe-155d-46c5-bc49-f98f1bbd6181 name=del-rig git_url=https://github.com/t/r.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=6fe469fe-155d-46c5-bc49-f98f1bbd6181 name=del-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=42da2af3-879c-4fe1-9617-027fd21b201b
[towns.handler] handleCreateRig: rig created id=42da2af3-879c-4fe1-9617-027fd21b201b, now configuring Rig DO
[Town.do] configureRig: rigId=42da2af3-879c-4fe1-9617-027fd21b201b hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=bb3748bbeef73d2cb065c000b4f66d9544f4adf3fdca466a49fd838b9e9f2cee
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738661-4447/rigs 201 (329ms)
[wrangler:info] POST /api/users/e2e-user-1771738661-4447/rigs 201 Created (329ms)
[gastown-worker] --> DELETE /api/users/e2e-user-1771738661-4447/rigs/42da2af3-879c-4fe1-9617-027fd21b201b
[gastown-worker] <-- DELETE /api/users/e2e-user-1771738661-4447/rigs/42da2af3-879c-4fe1-9617-027fd21b201b 200 (1ms)
[wrangler:info] DELETE /api/users/e2e-user-1771738661-4447/rigs/42da2af3-879c-4fe1-9617-027fd21b201b 200 OK (2ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738661-4447/towns/6fe469fe-155d-46c5-bc49-f98f1bbd6181/rigs
[gastown-worker] <-- GET /api/users/e2e-user-1771738661-4447/towns/6fe469fe-155d-46c5-bc49-f98f1bbd6181/rigs 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771738661-4447/towns/6fe469fe-155d-46c5-bc49-f98f1bbd6181/rigs 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738661-9841/towns
[GastownUser.do] createTown: id=e26902e5-e608-4880-b713-17d157879898 name=Bead-Town owner=e2e-user-1771738661-9841
[GastownUser.do] createTown: created town id=e26902e5-e608-4880-b713-17d157879898
[gastown-worker] <-- POST /api/users/e2e-user-1771738661-9841/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738661-9841/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738661-9841/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738661-9841 town_id=e26902e5-e608-4880-b713-17d157879898 name=bead-rig git_url=https://github.com/t/r.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=e26902e5-e608-4880-b713-17d157879898 name=bead-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=cd7eae24-20ff-4932-86df-ea1495190ba6
[towns.handler] handleCreateRig: rig created id=cd7eae24-20ff-4932-86df-ea1495190ba6, now configuring Rig DO
[Town.do] configureRig: rigId=cd7eae24-20ff-4932-86df-ea1495190ba6 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-kilo... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=8cd91481c9795a2721e2e468b56105ad7d6134b121d3dd482b97ef04fe59f83c
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738661-9841/rigs 201 (322ms)
[wrangler:info] POST /api/users/e2e-user-1771738661-9841/rigs 201 Created (323ms)
[gastown-worker] --> POST /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads
[rig-beads.handler] handleCreateBead: rigId=cd7eae24-20ff-4932-86df-ea1495190ba6 type=issue title="E2E test bead" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"fbc23071-48f1-4ca3-9a97-76d1a8946aa7","rig_id":"cd7eae24-20ff-4932-86df-ea1495190ba6","type":"issue","status":"open","title":"E2E test bead","body":"Test body","assignee_agent_id":null,"convoy_
[gastown-worker] <-- POST /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads 201 (1ms)
[wrangler:info] POST /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads 201 Created (2ms)
[gastown-worker] --> GET /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads
[gastown-worker] <-- GET /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads 200 (1ms)
[wrangler:info] GET /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads 200 OK (2ms)
[gastown-worker] --> GET /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads/fbc23071-48f1-4ca3-9a97-76d1a8946aa7
[gastown-worker] <-- GET /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads/fbc23071-48f1-4ca3-9a97-76d1a8946aa7 200 (1ms)
[wrangler:info] GET /api/towns/e26902e5-e608-4880-b713-17d157879898/rigs/cd7eae24-20ff-4932-86df-ea1495190ba6/beads/fbc23071-48f1-4ca3-9a97-76d1a8946aa7 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738662-26138/towns
[GastownUser.do] createTown: id=218a10fa-b9d0-4398-89f6-618d2e624bf6 name=Agent-Town owner=e2e-user-1771738662-26138
[GastownUser.do] createTown: created town id=218a10fa-b9d0-4398-89f6-618d2e624bf6
[gastown-worker] <-- POST /api/users/e2e-user-1771738662-26138/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738662-26138/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738662-26138/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738662-26138 town_id=218a10fa-b9d0-4398-89f6-618d2e624bf6 name=agent-rig git_url=https://github.com/t/r.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=218a10fa-b9d0-4398-89f6-618d2e624bf6 name=agent-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=63505336-5211-4e6f-82a3-9493ac0836a9
[towns.handler] handleCreateRig: rig created id=63505336-5211-4e6f-82a3-9493ac0836a9, now configuring Rig DO
[Town.do] configureRig: rigId=63505336-5211-4e6f-82a3-9493ac0836a9 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=d332a29d0406663b22f5f51fb2ffa194879495e43e838c102c2cef1bbdb140e7
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738662-26138/rigs 201 (322ms)
[wrangler:info] POST /api/users/e2e-user-1771738662-26138/rigs 201 Created (323ms)
[gastown-worker] --> POST /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents
[gastown-worker] <-- POST /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents 201 (1ms)
[wrangler:info] POST /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents 201 Created (2ms)
[gastown-worker] --> GET /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents
[gastown-worker] <-- GET /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents 200 (0ms)
[wrangler:info] GET /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents 200 OK (2ms)
[gastown-worker] --> GET /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents/fdc0b5e5-a546-45f0-9b98-2dca086533c5
[gastown-worker] <-- GET /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents/fdc0b5e5-a546-45f0-9b98-2dca086533c5 200 (0ms)
[wrangler:info] GET /api/towns/218a10fa-b9d0-4398-89f6-618d2e624bf6/rigs/63505336-5211-4e6f-82a3-9493ac0836a9/agents/fdc0b5e5-a546-45f0-9b98-2dca086533c5 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738662-6941/towns
[GastownUser.do] createTown: id=67c21394-727b-4f5c-b09e-f1d5928be01c name=Sling-Town owner=e2e-user-1771738662-6941
[GastownUser.do] createTown: created town id=67c21394-727b-4f5c-b09e-f1d5928be01c
[gastown-worker] <-- POST /api/users/e2e-user-1771738662-6941/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738662-6941/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738662-6941/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738662-6941 town_id=67c21394-727b-4f5c-b09e-f1d5928be01c name=sling-rig git_url=https://github.com/t/r.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=67c21394-727b-4f5c-b09e-f1d5928be01c name=sling-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=ad687d60-b660-4465-af71-9631b0084e38
[towns.handler] handleCreateRig: rig created id=ad687d60-b660-4465-af71-9631b0084e38, now configuring Rig DO
[Town.do] configureRig: rigId=ad687d60-b660-4465-af71-9631b0084e38 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=9b38fb54660de16909c3ed2974023c71a3259a0f948faa83d9279049a060badb
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738662-6941/rigs 201 (324ms)
[wrangler:info] POST /api/users/e2e-user-1771738662-6941/rigs 201 Created (326ms)
[gastown-worker] --> POST /api/towns/67c21394-727b-4f5c-b09e-f1d5928be01c/rigs/ad687d60-b660-4465-af71-9631b0084e38/sling
[rig-beads.handler] handleSlingBead: rigId=ad687d60-b660-4465-af71-9631b0084e38 title="Slung bead" metadata=undefined
[rig-beads.handler] handleSlingBead: completed, result={"bead":{"id":"4cbdd566-1861-4995-a4e1-b79a4e8ffaff","rig_id":"ad687d60-b660-4465-af71-9631b0084e38","type":"issue","status":"in_progress","title":"Slung bead","body":"Do something","assignee_agent_id":"e6d20c1e-bd5f-4481-9a61-7488f8148273","convoy_id":null,"molecule_id":null,"priority":"medium","la
[gastown-worker] <-- POST /api/towns/67c21394-727b-4f5c-b09e-f1d5928be01c/rigs/ad687d60-b660-4465-af71-9631b0084e38/sling 201 (1ms)
[wrangler:info] POST /api/towns/67c21394-727b-4f5c-b09e-f1d5928be01c/rigs/ad687d60-b660-4465-af71-9631b0084e38/sling 201 Created (3ms)
[gastown-worker] --> GET /api/towns/67c21394-727b-4f5c-b09e-f1d5928be01c/rigs/ad687d60-b660-4465-af71-9631b0084e38/agents/e6d20c1e-bd5f-4481-9a61-7488f8148273
[gastown-worker] <-- GET /api/towns/67c21394-727b-4f5c-b09e-f1d5928be01c/rigs/ad687d60-b660-4465-af71-9631b0084e38/agents/e6d20c1e-bd5f-4481-9a61-7488f8148273 200 (0ms)
[wrangler:info] GET /api/towns/67c21394-727b-4f5c-b09e-f1d5928be01c/rigs/ad687d60-b660-4465-af71-9631b0084e38/agents/e6d20c1e-bd5f-4481-9a61-7488f8148273 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738663-18695/towns
[GastownUser.do] createTown: id=0cafb181-6467-4756-830e-1a2386655692 name=Hook-Town owner=e2e-user-1771738663-18695
[GastownUser.do] createTown: created town id=0cafb181-6467-4756-830e-1a2386655692
[gastown-worker] <-- POST /api/users/e2e-user-1771738663-18695/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738663-18695/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738663-18695/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738663-18695 town_id=0cafb181-6467-4756-830e-1a2386655692 name=hook-rig git_url=https://github.com/t/r.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=0cafb181-6467-4756-830e-1a2386655692 name=hook-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=8a46b11b-d1d4-4699-a271-59159ab1bea2
[towns.handler] handleCreateRig: rig created id=8a46b11b-d1d4-4699-a271-59159ab1bea2, now configuring Rig DO
[Town.do] configureRig: rigId=8a46b11b-d1d4-4699-a271-59159ab1bea2 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=c3a520b93801a49fd78b63f7ba954276d667e566c3b9349ee95265a45a9c3bb6
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738663-18695/rigs 201 (321ms)
[wrangler:info] POST /api/users/e2e-user-1771738663-18695/rigs 201 Created (321ms)
[gastown-worker] --> POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents
[gastown-worker] <-- POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents 201 (1ms)
[wrangler:info] POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents 201 Created (1ms)
[gastown-worker] --> POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/beads
[rig-beads.handler] handleCreateBead: rigId=8a46b11b-d1d4-4699-a271-59159ab1bea2 type=issue title="Hook bead" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"2b2fef82-6416-4b4f-9e3c-bebb6980eead","rig_id":"8a46b11b-d1d4-4699-a271-59159ab1bea2","type":"issue","status":"open","title":"Hook bead","body":null,"assignee_agent_id":null,"convoy_id":null,"m
[gastown-worker] <-- POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/beads 201 (1ms)
[wrangler:info] POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/beads 201 Created (2ms)
[gastown-worker] --> POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e/hook
[rig-agents.handler] handleHookBead: rigId=8a46b11b-d1d4-4699-a271-59159ab1bea2 agentId=96bf27af-964e-40de-a33a-ad48833dc72e beadId=2b2fef82-6416-4b4f-9e3c-bebb6980eead
[rig-agents.handler] handleHookBead: hooked successfully
[gastown-worker] <-- POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e/hook 200 (0ms)
[wrangler:info] POST /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e/hook 200 OK (3ms)
[gastown-worker] --> GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e
[gastown-worker] <-- GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e 200 (1ms)
[wrangler:info] GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e 200 OK (1ms)
[gastown-worker] --> GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/beads/2b2fef82-6416-4b4f-9e3c-bebb6980eead
[gastown-worker] <-- GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/beads/2b2fef82-6416-4b4f-9e3c-bebb6980eead 200 (0ms)
[wrangler:info] GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/beads/2b2fef82-6416-4b4f-9e3c-bebb6980eead 200 OK (1ms)
[gastown-worker] --> DELETE /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e/hook
[gastown-worker] <-- DELETE /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e/hook 200 (1ms)
[wrangler:info] DELETE /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e/hook 200 OK (1ms)
[gastown-worker] --> GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e
[gastown-worker] <-- GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e 200 (0ms)
[wrangler:info] GET /api/towns/0cafb181-6467-4756-830e-1a2386655692/rigs/8a46b11b-d1d4-4699-a271-59159ab1bea2/agents/96bf27af-964e-40de-a33a-ad48833dc72e 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738663-7676/towns
[GastownUser.do] createTown: id=f93de68b-8abb-4099-bb93-b71cd66eb333 name=Mail-Town owner=e2e-user-1771738663-7676
[GastownUser.do] createTown: created town id=f93de68b-8abb-4099-bb93-b71cd66eb333
[gastown-worker] <-- POST /api/users/e2e-user-1771738663-7676/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738663-7676/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738663-7676/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738663-7676 town_id=f93de68b-8abb-4099-bb93-b71cd66eb333 name=mail-rig git_url=https://github.com/t/r.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=f93de68b-8abb-4099-bb93-b71cd66eb333 name=mail-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=c677dd1e-bb03-4102-9fa2-f11aae9ffaec
[towns.handler] handleCreateRig: rig created id=c677dd1e-bb03-4102-9fa2-f11aae9ffaec, now configuring Rig DO
[Town.do] configureRig: rigId=c677dd1e-bb03-4102-9fa2-f11aae9ffaec hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=dc0ab6ad34509b6201c7fd635556374e06d53ffe52861e35e5de8b66c0e7b451
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738663-7676/rigs 201 (322ms)
[wrangler:info] POST /api/users/e2e-user-1771738663-7676/rigs 201 Created (322ms)
[gastown-worker] --> POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents
[gastown-worker] <-- POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents 201 (1ms)
[wrangler:info] POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents 201 Created (2ms)
[gastown-worker] --> POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents
[gastown-worker] <-- POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents 201 (1ms)
[wrangler:info] POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents 201 Created (1ms)
[gastown-worker] --> POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/mail
[gastown-worker] <-- POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/mail 201 (0ms)
[wrangler:info] POST /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/mail 201 Created (2ms)
[gastown-worker] --> GET /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents/63c206c5-08e3-4772-b3c6-672e9b1a20cb/mail
[gastown-worker] <-- GET /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents/63c206c5-08e3-4772-b3c6-672e9b1a20cb/mail 200 (0ms)
[wrangler:info] GET /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents/63c206c5-08e3-4772-b3c6-672e9b1a20cb/mail 200 OK (2ms)
[gastown-worker] --> GET /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents/63c206c5-08e3-4772-b3c6-672e9b1a20cb/mail
[gastown-worker] <-- GET /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents/63c206c5-08e3-4772-b3c6-672e9b1a20cb/mail 200 (0ms)
[wrangler:info] GET /api/towns/f93de68b-8abb-4099-bb93-b71cd66eb333/rigs/c677dd1e-bb03-4102-9fa2-f11aae9ffaec/agents/63c206c5-08e3-4772-b3c6-672e9b1a20cb/mail 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738664-26699/towns
[GastownUser.do] createTown: id=1f03f195-b63c-4f7e-a797-7a733c7c349f name=Events-Town owner=e2e-user-1771738664-26699
[GastownUser.do] createTown: created town id=1f03f195-b63c-4f7e-a797-7a733c7c349f
[gastown-worker] <-- POST /api/users/e2e-user-1771738664-26699/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738664-26699/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738664-26699/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738664-26699 town_id=1f03f195-b63c-4f7e-a797-7a733c7c349f name=ev-rig git_url=https://github.com/t/r.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=1f03f195-b63c-4f7e-a797-7a733c7c349f name=ev-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=62d4500a-d634-4647-a187-4732c63d490c
[towns.handler] handleCreateRig: rig created id=62d4500a-d634-4647-a187-4732c63d490c, now configuring Rig DO
[Town.do] configureRig: rigId=62d4500a-d634-4647-a187-4732c63d490c hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=4df30c873670fe2b8c68c7c2a0eb7004be60decd1295a867ab4f7a88d11bcc10
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738664-26699/rigs 201 (321ms)
[wrangler:info] POST /api/users/e2e-user-1771738664-26699/rigs 201 Created (322ms)
[gastown-worker] --> POST /api/towns/1f03f195-b63c-4f7e-a797-7a733c7c349f/rigs/62d4500a-d634-4647-a187-4732c63d490c/sling
[rig-beads.handler] handleSlingBead: rigId=62d4500a-d634-4647-a187-4732c63d490c title="Event bead" metadata=undefined
[rig-beads.handler] handleSlingBead: completed, result={"bead":{"id":"0048204c-e9f8-4681-9cee-a55282aef4a2","rig_id":"62d4500a-d634-4647-a187-4732c63d490c","type":"issue","status":"in_progress","title":"Event bead","body":null,"assignee_agent_id":"ff7f9ecb-a406-46af-b503-35ea08168b6b","convoy_id":null,"molecule_id":null,"priority":"medium","labels":[],"
[gastown-worker] <-- POST /api/towns/1f03f195-b63c-4f7e-a797-7a733c7c349f/rigs/62d4500a-d634-4647-a187-4732c63d490c/sling 201 (1ms)
[wrangler:info] POST /api/towns/1f03f195-b63c-4f7e-a797-7a733c7c349f/rigs/62d4500a-d634-4647-a187-4732c63d490c/sling 201 Created (3ms)
[gastown-worker] --> GET /api/towns/1f03f195-b63c-4f7e-a797-7a733c7c349f/rigs/62d4500a-d634-4647-a187-4732c63d490c/events
[gastown-worker] <-- GET /api/towns/1f03f195-b63c-4f7e-a797-7a733c7c349f/rigs/62d4500a-d634-4647-a187-4732c63d490c/events 200 (0ms)
[wrangler:info] GET /api/towns/1f03f195-b63c-4f7e-a797-7a733c7c349f/rigs/62d4500a-d634-4647-a187-4732c63d490c/events 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738664-26641/towns
[GastownUser.do] createTown: id=fcb8229e-b1f2-40cd-9bf1-dd5698e42a59 name=Town-Alpha owner=e2e-user-1771738664-26641
[GastownUser.do] createTown: created town id=fcb8229e-b1f2-40cd-9bf1-dd5698e42a59
[gastown-worker] <-- POST /api/users/e2e-user-1771738664-26641/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738664-26641/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738664-26641/towns
[GastownUser.do] createTown: id=669ff108-c8be-4f0c-9ba8-13d6f91a9dff name=Town-Beta owner=e2e-user-1771738664-26641
[GastownUser.do] createTown: created town id=669ff108-c8be-4f0c-9ba8-13d6f91a9dff
[gastown-worker] <-- POST /api/users/e2e-user-1771738664-26641/towns 201 (0ms)
[wrangler:info] POST /api/users/e2e-user-1771738664-26641/towns 201 Created (2ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738664-26641/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771738664-26641/towns 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771738664-26641/towns 200 OK (2ms)
[gastown-worker] --> DELETE /api/users/e2e-user-1771738664-26641/towns/fcb8229e-b1f2-40cd-9bf1-dd5698e42a59
[Town.do] destroy: clearing all storage and alarms
[towns.handler] handleDeleteTown: Town DO destroyed for town fcb8229e-b1f2-40cd-9bf1-dd5698e42a59
[gastown-worker] <-- DELETE /api/users/e2e-user-1771738664-26641/towns/fcb8229e-b1f2-40cd-9bf1-dd5698e42a59 200 (4ms)
[wrangler:info] DELETE /api/users/e2e-user-1771738664-26641/towns/fcb8229e-b1f2-40cd-9bf1-dd5698e42a59 200 OK (4ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738664-26641/towns/669ff108-c8be-4f0c-9ba8-13d6f91a9dff
[gastown-worker] <-- GET /api/users/e2e-user-1771738664-26641/towns/669ff108-c8be-4f0c-9ba8-13d6f91a9dff 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771738664-26641/towns/669ff108-c8be-4f0c-9ba8-13d6f91a9dff 200 OK (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738664-26641/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771738664-26641/towns 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771738664-26641/towns 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738665-1993/towns
[GastownUser.do] createTown: id=980ba3c8-7714-4062-a20c-9cf23b35ccac name=EnvVar-Town owner=e2e-user-1771738665-1993
[GastownUser.do] createTown: created town id=980ba3c8-7714-4062-a20c-9cf23b35ccac
[gastown-worker] <-- POST /api/users/e2e-user-1771738665-1993/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738665-1993/towns 201 Created (2ms)
[gastown-worker] --> PATCH /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/config
[Town.do] updateTownConfig: saved config with 2 env vars
[town-config.handler] handleUpdateTownConfig: town=980ba3c8-7714-4062-a20c-9cf23b35ccac updated config
[gastown-worker] <-- PATCH /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/config 200 (2ms)
[wrangler:info] PATCH /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/config 200 OK (3ms)
[Town.do] alarm: fired for town=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/users/e2e-user-1771738665-1993/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738665-1993 town_id=980ba3c8-7714-4062-a20c-9cf23b35ccac name=envvar-rig git_url=https://github.com/t/r.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=980ba3c8-7714-4062-a20c-9cf23b35ccac name=envvar-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=741d7fe2-1bc3-4428-a4c5-2cd6623b984d
[towns.handler] handleCreateRig: rig created id=741d7fe2-1bc3-4428-a4c5-2cd6623b984d, now configuring Rig DO
[Town.do] configureRig: rigId=741d7fe2-1bc3-4428-a4c5-2cd6623b984d hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 2 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-toke... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=0bce15b1ee3d25b20dd23c13e994f0a5eab422936aee44036a6a21d17205a887
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738665-1993/rigs 201 (324ms)
[wrangler:info] POST /api/users/e2e-user-1771738665-1993/rigs 201 Created (324ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/mayor/message
[mayor.handler] handleSendMayorMessage: townId=980ba3c8-7714-4062-a20c-9cf23b35ccac message="env var test"
[Town.do] sendMayorMessage: townId=980ba3c8-7714-4062-a20c-9cf23b35ccac mayorId=24b27c49-e0c2-49b2-982e-f1e2c5bfd334 containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=980ba3c8-7714-4062-a20c-9cf23b35ccac hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-toke... stored
[Town.do] startAgentInContainer: agentId=24b27c49-e0c2-49b2-982e-f1e2c5bfd334 role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[CUSTOM_VAR,ANOTHER,GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[gastown-worker] --> POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events
[gastown-worker] <-- POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/7275b441-0abb-4b10-a04e-e4edbbb389d7/rigs/mayor-7275b441-0abb-4b10-a04e-e4edbbb389d7/agent-events 201 Created (3ms)
[Town.do] alarm: fired for town=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (0ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (4ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/mayor/message 200 (5575ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/mayor/message 200 OK (5577ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[gastown-worker] --> POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (6ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/rigs/mayor-980ba3c8-7714-4062-a20c-9cf23b35ccac/agent-events 201 Created (5ms)
[gastown-worker] --> GET /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/config
[gastown-worker] <-- GET /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/config 200 (0ms)
[wrangler:info] GET /api/towns/980ba3c8-7714-4062-a20c-9cf23b35ccac/config 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738674-31010/towns
[GastownUser.do] createTown: id=60ac36e2-541e-4a47-8c8d-f909035d4db5 name=Escalation-Town owner=e2e-user-1771738674-31010
[GastownUser.do] createTown: created town id=60ac36e2-541e-4a47-8c8d-f909035d4db5
[gastown-worker] <-- POST /api/users/e2e-user-1771738674-31010/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738674-31010/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738674-31010/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738674-31010 town_id=60ac36e2-541e-4a47-8c8d-f909035d4db5 name=esc-rig git_url=https://github.com/t/r.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=60ac36e2-541e-4a47-8c8d-f909035d4db5 name=esc-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=40ef3021-c3f8-4784-9fde-2fee4758ba73
[towns.handler] handleCreateRig: rig created id=40ef3021-c3f8-4784-9fde-2fee4758ba73, now configuring Rig DO
[Town.do] configureRig: rigId=40ef3021-c3f8-4784-9fde-2fee4758ba73 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=dbfe88e871af1aa869ddcf84e161ab9ded6704ea58597814620f2828dc085326
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738674-31010/rigs 201 (326ms)
[wrangler:info] POST /api/users/e2e-user-1771738674-31010/rigs 201 Created (327ms)
[gastown-worker] --> POST /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/rigs/40ef3021-c3f8-4784-9fde-2fee4758ba73/escalations
[gastown-worker] <-- POST /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/rigs/40ef3021-c3f8-4784-9fde-2fee4758ba73/escalations 201 (0ms)
[wrangler:info] POST /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/rigs/40ef3021-c3f8-4784-9fde-2fee4758ba73/escalations 201 Created (2ms)
[gastown-worker] --> GET /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/escalations
[gastown-worker] <-- GET /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/escalations 200 (1ms)
[wrangler:info] GET /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/escalations 200 OK (2ms)
[gastown-worker] --> GET /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/rigs/40ef3021-c3f8-4784-9fde-2fee4758ba73/beads
[gastown-worker] <-- GET /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/rigs/40ef3021-c3f8-4784-9fde-2fee4758ba73/beads 200 (0ms)
[wrangler:info] GET /api/towns/60ac36e2-541e-4a47-8c8d-f909035d4db5/rigs/40ef3021-c3f8-4784-9fde-2fee4758ba73/beads 200 OK (1ms)
[TownContainer.do] container stopped: exitCode=137 reason=exit id=bb3748bbeef73d2cb065c000b4f66d9544f4adf3fdca466a49fd838b9e9f2cee
[TownContainer.do] container stopped: exitCode=137 reason=exit id=9b38fb54660de16909c3ed2974023c71a3259a0f948faa83d9279049a060badb
[TownContainer.do] container stopped: exitCode=137 reason=exit id=c3a520b93801a49fd78b63f7ba954276d667e566c3b9349ee95265a45a9c3bb6
[TownContainer.do] container stopped: exitCode=137 reason=exit id=8cd91481c9795a2721e2e468b56105ad7d6134b121d3dd482b97ef04fe59f83c
[TownContainer.do] container stopped: exitCode=137 reason=exit id=dc0ab6ad34509b6201c7fd635556374e06d53ffe52861e35e5de8b66c0e7b451
[TownContainer.do] container stopped: exitCode=137 reason=exit id=dfc8fcf65a83aa8c3b805c2ff685550ba2cfbcea5f961016af430b30a129866d
[TownContainer.do] container stopped: exitCode=137 reason=exit id=de7431ffc9301f2094cd1a65e6929957d943e8ac0cc5c90983d8a94253877505
[TownContainer.do] container stopped: exitCode=137 reason=exit id=4df30c873670fe2b8c68c7c2a0eb7004be60decd1295a867ab4f7a88d11bcc10
[TownContainer.do] container stopped: exitCode=137 reason=exit id=d332a29d0406663b22f5f51fb2ffa194879495e43e838c102c2cef1bbdb140e7
[TownContainer.do] container stopped: exitCode=137 reason=exit id=dbfe88e871af1aa869ddcf84e161ab9ded6704ea58597814620f2828dc085326
[TownContainer.do] container stopped: exitCode=137 reason=exit id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4
[TownContainer.do] container stopped: exitCode=137 reason=exit id=0bce15b1ee3d25b20dd23c13e994f0a5eab422936aee44036a6a21d17205a887
[TownContainer.do] container stopped: exitCode=137 reason=exit id=98d3c6a15dd2f2b129d26e0c395f093d8a29820b2a98b6ec0af5b8472dbc0012
[TownContainer.do] container stopped: exitCode=137 reason=exit id=3ff00f29e9b6c26347b0c7fb22117c529471b76ee6adf2f633f7f15a729f7695
[Town.do] alarm: fired for town=0566798f-2acb-4335-b469-f231d73bd518
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=dfc8fcf65a83aa8c3b805c2ff685550ba2cfbcea5f961016af430b30a129866d


[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=7275b441-0abb-4b10-a04e-e4edbbb389d7
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[Town.do] alarm: fired for town=6fe469fe-155d-46c5-bc49-f98f1bbd6181
[Town.do] schedulePendingWork: found 0 pending agents
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=98d3c6a15dd2f2b129d26e0c395f093d8a29820b2a98b6ec0af5b8472dbc0012


[Town.do] schedulePendingWork: found 0 pending agents
Port 8080 is ready
[TownContainer.do] container started for DO id=98d3c6a15dd2f2b129d26e0c395f093d8a29820b2a98b6ec0af5b8472dbc0012
[Town.do] alarm: fired for town=e26902e5-e608-4880-b713-17d157879898
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=8cd91481c9795a2721e2e468b56105ad7d6134b121d3dd482b97ef04fe59f83c


[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=218a10fa-b9d0-4398-89f6-618d2e624bf6
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[TownContainer.do] container stopped: exitCode=137 reason=exit id=98d3c6a15dd2f2b129d26e0c395f093d8a29820b2a98b6ec0af5b8472dbc0012
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=d332a29d0406663b22f5f51fb2ffa194879495e43e838c102c2cef1bbdb140e7


[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/users/e2e-user-1771738674-3636/towns
[GastownUser.do] createTown: id=94da687f-c549-4d49-aa11-e94efc42bc0e name=Full-E2E-Town owner=e2e-user-1771738674-3636
[GastownUser.do] createTown: created town id=94da687f-c549-4d49-aa11-e94efc42bc0e
[gastown-worker] <-- POST /api/users/e2e-user-1771738674-3636/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738674-3636/towns 201 Created (2ms)
[gastown-worker] --> PATCH /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/config
[Town.do] updateTownConfig: saved config with 1 env vars
[town-config.handler] handleUpdateTownConfig: town=94da687f-c549-4d49-aa11-e94efc42bc0e updated config
[gastown-worker] <-- PATCH /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/config 200 (2ms)
[wrangler:info] PATCH /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/config 200 OK (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738674-3636/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738674-3636 town_id=94da687f-c549-4d49-aa11-e94efc42bc0e name=e2e-rig git_url=https://github.com/test/e2e.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=94da687f-c549-4d49-aa11-e94efc42bc0e name=e2e-rig git_url=https://github.com/test/e2e.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=acd99c37-14a8-4444-926a-bc5ae7f117c5
[towns.handler] handleCreateRig: rig created id=acd99c37-14a8-4444-926a-bc5ae7f117c5, now configuring Rig DO
[Town.do] configureRig: rigId=acd99c37-14a8-4444-926a-bc5ae7f117c5 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 1 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-full... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[Town.do] alarm: fired for town=67c21394-727b-4f5c-b09e-f1d5928be01c
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738674-3636/rigs 201 (320ms)
[wrangler:info] POST /api/users/e2e-user-1771738674-3636/rigs 201 Created (320ms)
[gastown-worker] --> GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/config
[gastown-worker] <-- GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/config 200 (1ms)
[wrangler:info] GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/config 200 OK (1ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads
[rig-beads.handler] handleCreateBead: rigId=acd99c37-14a8-4444-926a-bc5ae7f117c5 type=issue title="Build login page" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"0750c9ed-a817-49e4-8779-7ab83b9bd14b","rig_id":"acd99c37-14a8-4444-926a-bc5ae7f117c5","type":"issue","status":"open","title":"Build login page","body":null,"assignee_agent_id":null,"convoy_id":
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads 201 (0ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads 201 Created (2ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads
[rig-beads.handler] handleCreateBead: rigId=acd99c37-14a8-4444-926a-bc5ae7f117c5 type=issue title="Fix sidebar CSS" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"2c41f776-d9c0-475b-97e1-23a8541c0d6f","rig_id":"acd99c37-14a8-4444-926a-bc5ae7f117c5","type":"issue","status":"open","title":"Fix sidebar CSS","body":null,"assignee_agent_id":null,"convoy_id":n
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads 201 Created (2ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents 201 (0ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents 201 Created (2ms)
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=9b38fb54660de16909c3ed2974023c71a3259a0f948faa83d9279049a060badb


[Town.do] schedulePendingWork: found 1 pending agents
[Town.do] schedulePendingWork: agent=Toast(e6d20c1e-bd5f-4481-9a61-7488f8148273) rig_id=ad687d60-b660-4465-af71-9631b0084e38 resolved_rig=ad687d60-b660-4465-af71-9631b0084e38 hasConfig=true
[Town.do] startAgentInContainer: agentId=e6d20c1e-bd5f-4481-9a61-7488f8148273 role=polecat name=Toast
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN] hasJwt=true hasKilocodeToken=false paramToken=false configToken=false
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents/db9d934a-5f31-4566-9000-d8ee7e173bc3/hook
[rig-agents.handler] handleHookBead: rigId=acd99c37-14a8-4444-926a-bc5ae7f117c5 agentId=db9d934a-5f31-4566-9000-d8ee7e173bc3 beadId=0750c9ed-a817-49e4-8779-7ab83b9bd14b
[rig-agents.handler] handleHookBead: hooked successfully
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents/db9d934a-5f31-4566-9000-d8ee7e173bc3/hook 200 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents/db9d934a-5f31-4566-9000-d8ee7e173bc3/hook 200 OK (3ms)
Port 8080 is ready
[TownContainer.do] container started for DO id=9b38fb54660de16909c3ed2974023c71a3259a0f948faa83d9279049a060badb
[gastown-worker] --> GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads/0750c9ed-a817-49e4-8779-7ab83b9bd14b
[gastown-worker] <-- GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads/0750c9ed-a817-49e4-8779-7ab83b9bd14b 200 (0ms)
[wrangler:info] GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/beads/0750c9ed-a817-49e4-8779-7ab83b9bd14b 200 OK (1ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/sling
[rig-beads.handler] handleSlingBead: rigId=acd99c37-14a8-4444-926a-bc5ae7f117c5 title="Urgent hotfix" metadata=undefined
[rig-beads.handler] handleSlingBead: completed, result={"bead":{"id":"ed68b665-a8d4-4701-9bcf-7f81efee80f6","rig_id":"acd99c37-14a8-4444-926a-bc5ae7f117c5","type":"issue","status":"in_progress","title":"Urgent hotfix","body":null,"assignee_agent_id":"5404fb72-b9f9-4649-ad7b-89e3324ec0aa","convoy_id":null,"molecule_id":null,"priority":"medium","labels":[
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/sling 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/sling 201 Created (2ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/mail
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/mail 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/mail 201 Created (2ms)
[gastown-worker] --> GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/events
[gastown-worker] <-- GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/events 200 (0ms)
[wrangler:info] GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/events 200 OK (1ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/mayor/message
[mayor.handler] handleSendMayorMessage: townId=94da687f-c549-4d49-aa11-e94efc42bc0e message="What is the status of our project?"
[Town.do] sendMayorMessage: townId=94da687f-c549-4d49-aa11-e94efc42bc0e mayorId=b91e5e92-5303-4c4a-81db-2b1773343318 containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=94da687f-c549-4d49-aa11-e94efc42bc0e hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-full... stored
[Town.do] startAgentInContainer: agentId=b91e5e92-5303-4c4a-81db-2b1773343318 role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[PROJECT,GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[Town.do] alarm: fired for town=0cafb181-6467-4756-830e-1a2386655692
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=c3a520b93801a49fd78b63f7ba954276d667e566c3b9349ee95265a45a9c3bb6


[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=f93de68b-8abb-4099-bb93-b71cd66eb333
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[TownContainer.do] container stopped: exitCode=137 reason=exit id=9b38fb54660de16909c3ed2974023c71a3259a0f948faa83d9279049a060badb
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=dc0ab6ad34509b6201c7fd635556374e06d53ffe52861e35e5de8b66c0e7b451


[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=1f03f195-b63c-4f7e-a797-7a733c7c349f
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=4df30c873670fe2b8c68c7c2a0eb7004be60decd1295a867ab4f7a88d11bcc10


[Town.do] schedulePendingWork: found 1 pending agents
[Town.do] schedulePendingWork: agent=Toast(ff7f9ecb-a406-46af-b503-35ea08168b6b) rig_id=62d4500a-d634-4647-a187-4732c63d490c resolved_rig=62d4500a-d634-4647-a187-4732c63d490c hasConfig=true
[Town.do] startAgentInContainer: agentId=ff7f9ecb-a406-46af-b503-35ea08168b6b role=polecat name=Toast
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN] hasJwt=true hasKilocodeToken=false paramToken=false configToken=false
Port 8080 is ready
[TownContainer.do] container started for DO id=4df30c873670fe2b8c68c7c2a0eb7004be60decd1295a867ab4f7a88d11bcc10
[Town.do] alarm: fired for town=f77e78b3-7b08-499b-8d6c-a3dd3d0cb7cd
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[Town.do] alarm: fired for town=980ba3c8-7714-4062-a20c-9cf23b35ccac
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=3ff00f29e9b6c26347b0c7fb22117c529471b76ee6adf2f633f7f15a729f7695


[Town.do] schedulePendingWork: found 0 pending agents
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=0bce15b1ee3d25b20dd23c13e994f0a5eab422936aee44036a6a21d17205a887


[Town.do] schedulePendingWork: found 0 pending agents
Port 8080 is ready
[TownContainer.do] container started for DO id=3ff00f29e9b6c26347b0c7fb22117c529471b76ee6adf2f633f7f15a729f7695
[TownContainer.do] container stopped: exitCode=137 reason=exit id=4df30c873670fe2b8c68c7c2a0eb7004be60decd1295a867ab4f7a88d11bcc10
[TownContainer.do] container stopped: exitCode=137 reason=exit id=3ff00f29e9b6c26347b0c7fb22117c529471b76ee6adf2f633f7f15a729f7695
[Town.do] alarm: fired for town=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4


[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (4ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (6ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (0ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (0ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (0ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (1ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/mayor/message 200 (5663ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/mayor/message 200 OK (5666ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (3ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] --> POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (6ms)
[wrangler:info] POST /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/mayor-94da687f-c549-4d49-aa11-e94efc42bc0e/agent-events 201 Created (6ms)
Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=0bce15b1ee3d25b20dd23c13e994f0a5eab422936aee44036a6a21d17205a887


Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4


[Town.do] alarm: fired for town=60ac36e2-541e-4a47-8c8d-f909035d4db5
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=dbfe88e871af1aa869ddcf84e161ab9ded6704ea58597814620f2828dc085326


[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/mayor/status
[gastown-worker] <-- GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/mayor/status 200 (1ms)
[wrangler:info] GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/mayor/status 200 OK (1ms)
[gastown-worker] --> GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents
[gastown-worker] <-- GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents 200 (0ms)
[wrangler:info] GET /api/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/rigs/acd99c37-14a8-4444-926a-bc5ae7f117c5/agents 200 OK (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771738674-3636/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/events
[gastown-worker] <-- GET /api/users/e2e-user-1771738674-3636/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/events 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771738674-3636/towns/94da687f-c549-4d49-aa11-e94efc42bc0e/events 200 OK (1ms)
[Town.do] alarm: fired for town=94da687f-c549-4d49-aa11-e94efc42bc0e
[TownContainer.do] container stopped: exitCode=137 reason=exit id=6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mError proxying request to container 6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba: Error: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.[0m

      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:717:19)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) {
    retryable: true
  }


[Town.do] schedulePendingWork: found 2 pending agents
[Town.do] schedulePendingWork: agent=E2E-Polecat(db9d934a-5f31-4566-9000-d8ee7e173bc3) rig_id=acd99c37-14a8-4444-926a-bc5ae7f117c5 resolved_rig=acd99c37-14a8-4444-926a-bc5ae7f117c5 hasConfig=true
[Town.do] schedulePendingWork: agent=Toast(5404fb72-b9f9-4649-ad7b-89e3324ec0aa) rig_id=acd99c37-14a8-4444-926a-bc5ae7f117c5 resolved_rig=acd99c37-14a8-4444-926a-bc5ae7f117c5 hasConfig=true
[Town.do] startAgentInContainer: agentId=db9d934a-5f31-4566-9000-d8ee7e173bc3 role=polecat name=E2E-Polecat
[Town.do] startAgentInContainer: agentId=5404fb72-b9f9-4649-ad7b-89e3324ec0aa role=polecat name=Toast
[Town.do] startAgentInContainer: envVars built: keys=[PROJECT,GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[Town.do] startAgentInContainer: envVars built: keys=[PROJECT,GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[Town.do] startAgentInContainer: error response: Failed to start container: Container exited with unexpected exit code: 137[0m


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[Town.do] startAgentInContainer: error response: Failed to start container: Container exited with unexpected exit code: 137[0m


[gastown-worker] --> POST /api/users/e2e-user-1771738692-9224/towns
[GastownUser.do] createTown: id=27e23803-2519-4867-b143-80facf2d7695 name=Deep-Config-Town owner=e2e-user-1771738692-9224
[GastownUser.do] createTown: created town id=27e23803-2519-4867-b143-80facf2d7695
[gastown-worker] <-- POST /api/users/e2e-user-1771738692-9224/towns 201 (4ms)
[wrangler:info] POST /api/users/e2e-user-1771738692-9224/towns 201 Created (5ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738692-9224/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738692-9224 town_id=27e23803-2519-4867-b143-80facf2d7695 name=deep-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=27e23803-2519-4867-b143-80facf2d7695 name=deep-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=0fc637e6-7731-4825-b1c8-d58bd16d146d
[towns.handler] handleCreateRig: rig created id=0fc637e6-7731-4825-b1c8-d58bd16d146d, now configuring Rig DO
[Town.do] configureRig: rigId=0fc637e6-7731-4825-b1c8-d58bd16d146d hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-deep... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=aef5c2cb99fe737591d0093ee9fe284b36952743b2b9fac896f498460643fa52
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738692-9224/rigs 201 (324ms)
[wrangler:info] POST /api/users/e2e-user-1771738692-9224/rigs 201 Created (326ms)
[gastown-worker] --> GET /api/towns/27e23803-2519-4867-b143-80facf2d7695/config
[gastown-worker] <-- GET /api/towns/27e23803-2519-4867-b143-80facf2d7695/config 200 (1ms)
[wrangler:info] GET /api/towns/27e23803-2519-4867-b143-80facf2d7695/config 200 OK (2ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/mayor/message
[mayor.handler] handleSendMayorMessage: townId=27e23803-2519-4867-b143-80facf2d7695 message="Deep config test"
[Town.do] sendMayorMessage: townId=27e23803-2519-4867-b143-80facf2d7695 mayorId=7f35c569-ef07-4fb8-870e-f2095c381461 containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=27e23803-2519-4867-b143-80facf2d7695 hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-deep... stored
[Town.do] startAgentInContainer: agentId=7f35c569-ef07-4fb8-870e-f2095c381461 role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba


[Town.do] alarm: fired for town=980ba3c8-7714-4062-a20c-9cf23b35ccac
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (4ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (0ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (3ms)
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=0bce15b1ee3d25b20dd23c13e994f0a5eab422936aee44036a6a21d17205a887


[Town.do] schedulePendingWork: found 0 pending agents
Port 8080 is ready
[TownContainer.do] container started for DO id=0bce15b1ee3d25b20dd23c13e994f0a5eab422936aee44036a6a21d17205a887
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (1ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/mayor/message 200 (5600ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/mayor/message 200 OK (5602ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (0ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (5ms)
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[gastown-worker] --> POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (5ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/27e23803-2519-4867-b143-80facf2d7695/rigs/mayor-27e23803-2519-4867-b143-80facf2d7695/agent-events 201 Created (5ms)
[TownContainer.do] container stopped: exitCode=137 reason=exit id=0bce15b1ee3d25b20dd23c13e994f0a5eab422936aee44036a6a21d17205a887
[Town.do] alarm: fired for town=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4


[Town.do] schedulePendingWork: found 0 pending agents
Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4


[Town.do] alarm: fired for town=27e23803-2519-4867-b143-80facf2d7695
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=94da687f-c549-4d49-aa11-e94efc42bc0e
Port 8080 is ready
[TownContainer.do] container started for DO id=6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba
[TownContainer.do] container stopped: exitCode=137 reason=exit id=6c22ae08004e9f1d3d804019da275a84b2410c4a15e3e510767f9d1e954253ba
[TownContainer.do] container stopped: exitCode=137 reason=exit id=aef5c2cb99fe737591d0093ee9fe284b36952743b2b9fac896f498460643fa52
[Town.do] alarm: fired for town=1dffa8d5-5ca7-423f-9630-c4c15bf2aab4
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4


[Town.do] schedulePendingWork: found 0 pending agents
Port 8080 is ready
[TownContainer.do] container started for DO id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4
[gastown-worker] --> POST /api/users/e2e-user-1771738721-32558/towns
[GastownUser.do] createTown: id=c594164e-205b-470c-94fa-7a08d94db676 name=WS-Events-Town owner=e2e-user-1771738721-32558
[GastownUser.do] createTown: created town id=c594164e-205b-470c-94fa-7a08d94db676
[gastown-worker] <-- POST /api/users/e2e-user-1771738721-32558/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738721-32558/towns 201 Created (4ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738721-32558/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738721-32558 town_id=c594164e-205b-470c-94fa-7a08d94db676 name=ws-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=c594164e-205b-470c-94fa-7a08d94db676 name=ws-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=b8c57f8f-2b19-4691-8be9-54e208d7f8b4
[towns.handler] handleCreateRig: rig created id=b8c57f8f-2b19-4691-8be9-54e208d7f8b4, now configuring Rig DO
[Town.do] configureRig: rigId=b8c57f8f-2b19-4691-8be9-54e208d7f8b4 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-ws-t... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=82aed9402c5a64557dc4e6c14c37fdc45c8887f85b98843a33b2784f3ffe65f5
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738721-32558/rigs 201 (326ms)
[wrangler:info] POST /api/users/e2e-user-1771738721-32558/rigs 201 Created (327ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/mayor/message
[mayor.handler] handleSendMayorMessage: townId=c594164e-205b-470c-94fa-7a08d94db676 message="Say hello world in one sentence"
[Town.do] sendMayorMessage: townId=c594164e-205b-470c-94fa-7a08d94db676 mayorId=3df0d0fc-6618-4552-a058-8beecb92dfda containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=c594164e-205b-470c-94fa-7a08d94db676 hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-ws-t... stored
[Town.do] startAgentInContainer: agentId=3df0d0fc-6618-4552-a058-8beecb92dfda role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[TownContainer.do] container stopped: exitCode=137 reason=exit id=abe53451599d2350f4ce8b9ecffb37bfdf7b448280cfd26f3dde8398abe844d4
[Town.do] alarm: fired for town=27e23803-2519-4867-b143-80facf2d7695
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=aef5c2cb99fe737591d0093ee9fe284b36952743b2b9fac896f498460643fa52


[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (0ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (0ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/mayor/message 200 (5593ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/mayor/message 200 OK (5594ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (4ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (3ms)
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (3ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (6ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (7ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (5ms)
Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=aef5c2cb99fe737591d0093ee9fe284b36952743b2b9fac896f498460643fa52


[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=27e23803-2519-4867-b143-80facf2d7695
Port 8080 is ready
[TownContainer.do] container started for DO id=aef5c2cb99fe737591d0093ee9fe284b36952743b2b9fac896f498460643fa52
[TownContainer.do] container stopped: exitCode=137 reason=exit id=aef5c2cb99fe737591d0093ee9fe284b36952743b2b9fac896f498460643fa52
[gastown-worker] WS upgrade: townId=c594164e-205b-470c-94fa-7a08d94db676 agentId=3df0d0fc-6618-4552-a058-8beecb92dfda
[wrangler:info] GET /api/towns/c594164e-205b-470c-94fa-7a08d94db676/container/agents/3df0d0fc-6618-4552-a058-8beecb92dfda/stream 101 Switching Protocols (8ms)
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events
[gastown-worker] <-- POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/c594164e-205b-470c-94fa-7a08d94db676/rigs/mayor-c594164e-205b-470c-94fa-7a08d94db676/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738767-32635/towns
[GastownUser.do] createTown: id=b5ad6fb5-25b4-4602-a6e4-a7936659f484 name=Token-Trace-Town owner=e2e-user-1771738767-32635
[GastownUser.do] createTown: created town id=b5ad6fb5-25b4-4602-a6e4-a7936659f484
[gastown-worker] <-- POST /api/users/e2e-user-1771738767-32635/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738767-32635/towns 201 Created (4ms)
[gastown-worker] --> GET /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/config
[gastown-worker] <-- GET /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/config 200 (2ms)
[wrangler:info] GET /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/config 200 OK (4ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738767-32635/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738767-32635 town_id=b5ad6fb5-25b4-4602-a6e4-a7936659f484 name=trace-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=b5ad6fb5-25b4-4602-a6e4-a7936659f484 name=trace-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=c2479a29-ade8-40f2-b159-f465854e4b46
[towns.handler] handleCreateRig: rig created id=c2479a29-ade8-40f2-b159-f465854e4b46, now configuring Rig DO
[Town.do] configureRig: rigId=c2479a29-ade8-40f2-b159-f465854e4b46 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-trac... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738767-32635/rigs 201 (326ms)
[wrangler:info] POST /api/users/e2e-user-1771738767-32635/rigs 201 Created (328ms)
[gastown-worker] --> GET /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/config
[gastown-worker] <-- GET /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/config 200 (0ms)
[wrangler:info] GET /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/config 200 OK (1ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/mayor/message
[mayor.handler] handleSendMayorMessage: townId=b5ad6fb5-25b4-4602-a6e4-a7936659f484 message="Token trace test"
[Town.do] sendMayorMessage: townId=b5ad6fb5-25b4-4602-a6e4-a7936659f484 mayorId=acb9f096-f28b-40bf-aac5-d6f0ee558ba7 containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=b5ad6fb5-25b4-4602-a6e4-a7936659f484 hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-trac... stored
[Town.do] startAgentInContainer: agentId=acb9f096-f28b-40bf-aac5-d6f0ee558ba7 role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (2ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/mayor/message 200 (5598ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/mayor/message 200 OK (5600ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (3ms)
[gastown-worker] <-- POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 (3ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (6ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/b5ad6fb5-25b4-4602-a6e4-a7936659f484/rigs/mayor-b5ad6fb5-25b4-4602-a6e4-a7936659f484/agent-events 201 Created (5ms)
[Town.do] alarm: fired for town=b5ad6fb5-25b4-4602-a6e4-a7936659f484
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
[TownContainer.do] container stopped: exitCode=137 reason=exit id=82aed9402c5a64557dc4e6c14c37fdc45c8887f85b98843a33b2784f3ffe65f5
[TownContainer.do] container stopped: exitCode=137 reason=exit id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac
[gastown-worker] --> POST /api/users/e2e-user-1771738788-16532/towns
[GastownUser.do] createTown: id=11e347a1-9739-43e4-8b91-1a0ebd400968 name=Stream-Ticket-Town owner=e2e-user-1771738788-16532
[GastownUser.do] createTown: created town id=11e347a1-9739-43e4-8b91-1a0ebd400968
[gastown-worker] <-- POST /api/users/e2e-user-1771738788-16532/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738788-16532/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738788-16532/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738788-16532 town_id=11e347a1-9739-43e4-8b91-1a0ebd400968 name=st-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=11e347a1-9739-43e4-8b91-1a0ebd400968 name=st-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=4410de53-fcd0-4011-ae72-65c23cb6de05
[towns.handler] handleCreateRig: rig created id=4410de53-fcd0-4011-ae72-65c23cb6de05, now configuring Rig DO
[Town.do] configureRig: rigId=4410de53-fcd0-4011-ae72-65c23cb6de05 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-stre... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=3d331c31614ff44089384e1ba3c5f050781ab19afe4ecb88496438ce9a23fc14
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738788-16532/rigs 201 (325ms)
[wrangler:info] POST /api/users/e2e-user-1771738788-16532/rigs 201 Created (326ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/mayor/message
[mayor.handler] handleSendMayorMessage: townId=11e347a1-9739-43e4-8b91-1a0ebd400968 message="Stream ticket test"
[Town.do] sendMayorMessage: townId=11e347a1-9739-43e4-8b91-1a0ebd400968 mayorId=0c2903d5-a369-4d02-a1b8-6904c1e083cb containerStatus=unknown isAlive=false
[Town.do] sendMayorMessage: townId=11e347a1-9739-43e4-8b91-1a0ebd400968 hasRigConfig=true hasKilocodeToken=true townConfigToken=true rigConfigToken=true
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-stre... stored
[Town.do] startAgentInContainer: agentId=0c2903d5-a369-4d02-a1b8-6904c1e083cb role=mayor name=mayor
[Town.do] startAgentInContainer: envVars built: keys=[GASTOWN_SESSION_TOKEN,KILOCODE_TOKEN] hasJwt=true hasKilocodeToken=true paramToken=true configToken=true
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (3ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (0ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (2ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (1ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (3ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (3ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (1ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/mayor/message 200 (5643ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/mayor/message 200 OK (5644ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (2ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (2ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (2ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (1ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (5ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (5ms)
[Town.do] alarm: fired for town=b5ad6fb5-25b4-4602-a6e4-a7936659f484
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac


[Town.do] schedulePendingWork: found 0 pending agents
Port 8080 is ready
[TownContainer.do] container started for DO id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac
[TownContainer.do] container stopped: exitCode=137 reason=exit id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=82aed9402c5a64557dc4e6c14c37fdc45c8887f85b98843a33b2784f3ffe65f5
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=11e347a1-9739-43e4-8b91-1a0ebd400968
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/container/agents/0c2903d5-a369-4d02-a1b8-6904c1e083cb/stream-ticket
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/container/agents/0c2903d5-a369-4d02-a1b8-6904c1e083cb/stream-ticket 200 (7ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/container/agents/0c2903d5-a369-4d02-a1b8-6904c1e083cb/stream-ticket 200 OK (9ms)
[gastown-worker] WS upgrade: townId=11e347a1-9739-43e4-8b91-1a0ebd400968 agentId=0c2903d5-a369-4d02-a1b8-6904c1e083cb
[wrangler:info] GET /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/container/agents/0c2903d5-a369-4d02-a1b8-6904c1e083cb/stream 101 Switching Protocols (7ms)
[Town.do] alarm: fired for town=b5ad6fb5-25b4-4602-a6e4-a7936659f484
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac


[Town.do] schedulePendingWork: found 0 pending agents
Port 8080 is ready
[TownContainer.do] container started for DO id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac
[TownContainer.do] container stopped: exitCode=137 reason=exit id=f66647053a365c2a7345b659a7f4cb7d4e77c1f6b8474018ef9945e6598cadac
[Town.do] alarm: fired for town=11e347a1-9739-43e4-8b91-1a0ebd400968
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/users/e2e-user-1771738824-102/towns
[GastownUser.do] createTown: id=26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a name=No-Token-Town owner=e2e-user-1771738824-102
[GastownUser.do] createTown: created town id=26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a
[gastown-worker] <-- POST /api/users/e2e-user-1771738824-102/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771738824-102/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738824-102/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738824-102 town_id=26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a name=no-token-rig git_url=https://github.com/test/repo.git hasKilocodeToken=false
[GastownUser.do] createRig: town_id=26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a name=no-token-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=a738b2e9-d87d-483e-ab89-49e1a0e90e08
[towns.handler] handleCreateRig: rig created id=a738b2e9-d87d-483e-ab89-49e1a0e90e08, now configuring Rig DO
[Town.do] configureRig: rigId=a738b2e9-d87d-483e-ab89-49e1a0e90e08 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=95cd7f3cd8b42e5759ce7491c1c7940ca23455cf2c8098713eaf9fb0f3e03ea6
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738824-102/rigs 201 (323ms)
[wrangler:info] POST /api/users/e2e-user-1771738824-102/rigs 201 Created (324ms)
[gastown-worker] --> GET /api/towns/26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a/config
[gastown-worker] <-- GET /api/towns/26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a/config 200 (1ms)
[wrangler:info] GET /api/towns/26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a/config 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738824-1861/towns
[GastownUser.do] createTown: id=565244aa-3187-497c-9a6b-25147e2fd180 name=NextJS-Token-Town owner=e2e-user-1771738824-1861
[GastownUser.do] createTown: created town id=565244aa-3187-497c-9a6b-25147e2fd180
[gastown-worker] <-- POST /api/users/e2e-user-1771738824-1861/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771738824-1861/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771738824-1861/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771738824-1861 town_id=565244aa-3187-497c-9a6b-25147e2fd180 name=nextjs-rig git_url=https://github.com/test/repo.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=565244aa-3187-497c-9a6b-25147e2fd180 name=nextjs-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=1022ab0e-0dd6-433f-a03d-f25b9ed4dcb0
[towns.handler] handleCreateRig: rig created id=1022ab0e-0dd6-433f-a03d-f25b9ed4dcb0, now configuring Rig DO
[Town.do] configureRig: rigId=1022ab0e-0dd6-433f-a03d-f25b9ed4dcb0 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=e2e-next... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=634b46cb37e44efda83e9d13ae0a6c0312a4b4f40077ee5909b9cfb050b9469a
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771738824-1861/rigs 201 (321ms)
[wrangler:info] POST /api/users/e2e-user-1771738824-1861/rigs 201 Created (321ms)
[gastown-worker] --> GET /api/towns/565244aa-3187-497c-9a6b-25147e2fd180/config
[gastown-worker] <-- GET /api/towns/565244aa-3187-497c-9a6b-25147e2fd180/config 200 (0ms)
[wrangler:info] GET /api/towns/565244aa-3187-497c-9a6b-25147e2fd180/config 200 OK (1ms)
[gastown-worker] --> GET /health
[gastown-worker] <-- GET /health 200 (0ms)
[wrangler:info] GET /health 200 OK (1ms)
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (3ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (3ms)
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=11e347a1-9739-43e4-8b91-1a0ebd400968
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=26f460e8-2991-4fff-a5c2-e1ec3ad4ce5a
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=565244aa-3187-497c-9a6b-25147e2fd180
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
[Town.do] alarm: fired for town=11e347a1-9739-43e4-8b91-1a0ebd400968
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events
[gastown-worker] <-- POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 (3ms)
[wrangler:info] POST /api/towns/11e347a1-9739-43e4-8b91-1a0ebd400968/rigs/mayor-11e347a1-9739-43e4-8b91-1a0ebd400968/agent-events 201 Created (4ms)
[Town.do] alarm: fired for town=c594164e-205b-470c-94fa-7a08d94db676
[Town.do] schedulePendingWork: found 0 pending agents
[gastown-worker] --> POST /api/users/trpc-fallback-1771738864-6885/towns
[GastownUser.do] createTown: id=75cad885-be8b-44af-85f8-223f05cac262 name=Direct-Token-Town owner=trpc-fallback-1771738864-6885
[GastownUser.do] createTown: created town id=75cad885-be8b-44af-85f8-223f05cac262
[gastown-worker] <-- POST /api/users/trpc-fallback-1771738864-6885/towns 201 (1ms)
[wrangler:info] POST /api/users/trpc-fallback-1771738864-6885/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/trpc-fallback-1771738864-6885/rigs
[towns.handler] handleCreateRig: userId=trpc-fallback-1771738864-6885 town_id=75cad885-be8b-44af-85f8-223f05cac262 name=direct-rig git_url=https://github.com/t/r.git hasKilocodeToken=true
[GastownUser.do] createRig: town_id=75cad885-be8b-44af-85f8-223f05cac262 name=direct-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=3e8913f0-2d94-4bed-acb6-4484400014ee
[towns.handler] handleCreateRig: rig created id=3e8913f0-2d94-4bed-acb6-4484400014ee, now configuring Rig DO
[Town.do] configureRig: rigId=3e8913f0-2d94-4bed-acb6-4484400014ee hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[TownContainer.do] setEnvVar: KILOCODE_TOKEN=trpc-tes... stored
[Town.do] configureRig: stored KILOCODE_TOKEN on TownContainerDO
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=397c3994e68c70d9bef9d0b066047c3043e4539d4bee508db9787460f7ca92fa
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/trpc-fallback-1771738864-6885/rigs 201 (327ms)
[wrangler:info] POST /api/users/trpc-fallback-1771738864-6885/rigs 201 Created (327ms)
[gastown-worker] --> GET /api/towns/75cad885-be8b-44af-85f8-223f05cac262/config
[gastown-worker] <-- GET /api/towns/75cad885-be8b-44af-85f8-223f05cac262/config 200 (0ms)
[wrangler:info] GET /api/towns/75cad885-be8b-44af-85f8-223f05cac262/config 200 OK (1ms)
ðŸªµ  Logs were written to "/Users/john/Library/Preferences/.wrangler/logs/wrangler-2026-02-22_05-36-56_169.log"
