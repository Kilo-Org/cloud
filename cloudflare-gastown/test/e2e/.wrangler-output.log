[33mâ–² [43;33m[[43;30mWARNING[43;33m][0m [1mUnrecognised WRANGLER_LOG value "/users/john/projects/professional/kilo/cloud/cloudflare-gastown/test/e2e/.wrangler-output.log", expected "none" | "error" | "warn" | "info" | "log" | "debug", defaulting to "log"...[0m



 â›…ï¸ wrangler 4.61.1 (update available 4.67.0)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Your Worker has access to the following bindings:
Binding                                                                                Resource                  Mode
env.GASTOWN_USER (GastownUserDO)                                                       Durable Object            local
env.AGENT_IDENTITY (AgentIdentityDO)                                                   Durable Object            local
env.TOWN (TownDO)                                                                      Durable Object            local
env.TOWN_CONTAINER (TownContainerDO)                                                   Durable Object            local
env.AGENT (AgentDO)                                                                    Durable Object            local
env.GASTOWN_JWT_SECRET (342a86d9e3a94da698e82d0c6e2a36f0/GASTOWN_JWT_SECRET_PROD)      Secrets Store Secret      local
env.ENVIRONMENT ("development")                                                        Environment Variable      local
env.CF_ACCESS_TEAM ("engineering-e11")                                                 Environment Variable      local
env.CF_ACCESS_AUD ("f30e3fd893df52fa3ffc50fbdb5ee6a4f1116...")                         Environment Variable      local
env.KILO_API_URL ("http://host.docker.internal:3000")                                  Environment Variable      local
env.GASTOWN_API_URL ("(hidden)")                                                       Environment Variable      local

The following containers are available:
- gastown-dev-TownContainerDO (/Users/john/projects/professional/kilo/cloud/cloudflare-gastown/container/Dockerfile.dev)

âŽ” Preparing container image(s)...
#0 building with "desktop-linux" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 2.49kB done
#1 WARN: FromPlatformFlagConstDisallowed: FROM --platform flag should not use constant value "linux/arm64" (line 1)
#1 DONE 0.0s

#2 [auth] oven/bun:pull token for registry-1.docker.io
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/oven/bun:1-slim
#3 DONE 0.4s

#4 [internal] load .dockerignore
#4 transferring context: 2B done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 758B done
#5 DONE 0.0s

#6 [ 1/10] FROM docker.io/oven/bun:1-slim@sha256:8ca06c7812d9050ccc4b80799685f395d6a0d051d3b7207dfd120e2b437b1ec9
#6 resolve docker.io/oven/bun:1-slim@sha256:8ca06c7812d9050ccc4b80799685f395d6a0d051d3b7207dfd120e2b437b1ec9 done
#6 DONE 0.0s

#7 [ 7/10] WORKDIR /app
#7 CACHED

#8 [ 9/10] RUN bun install --frozen-lockfile --production
#8 CACHED

#9 [ 4/10] RUN mkdir -p /workspace/rigs /app
#9 CACHED

#10 [ 6/10] RUN cd /opt/gastown-plugin && npm install --omit=dev &&     mkdir -p /root/.config/kilo/plugins &&     ln -s /opt/gastown-plugin/index.ts /root/.config/kilo/plugins/gastown.ts
#10 CACHED

#11 [ 8/10] COPY package.json bun.lock ./
#11 CACHED

#12 [ 2/10] RUN apt-get update &&     apt-get install -y --no-install-recommends git curl ca-certificates &&     curl -fsSL https://deb.nodesource.com/setup_22.x | bash - &&     apt-get install -y --no-install-recommends nodejs &&     curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg       -o /usr/share/keyrings/githubcli-archive-keyring.gpg &&     echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main"       > /etc/apt/sources.list.d/github-cli.list &&     apt-get update &&     apt-get install -y --no-install-recommends gh &&     apt-get clean &&     rm -rf /var/lib/apt/lists/*
#12 CACHED

#13 [ 3/10] RUN npm install -g @kilocode/cli @kilocode/cli-linux-arm64 @kilocode/cli-linux-arm64-musl &&     ln -s "$(which kilo)" /usr/local/bin/opencode
#13 CACHED

#14 [ 5/10] COPY plugin/ /opt/gastown-plugin/
#14 CACHED

#15 [10/10] COPY src/ ./src/
#15 CACHED

#16 exporting to image
#16 exporting layers done
#16 exporting manifest sha256:bf9676d351019734e21c7303383091d020717e1de29eaddea16fcaa9891ef42e done
#16 exporting config sha256:7c28b7f1d485a1330461b4c962ad943eb4943885fb8de01248278591f53e8b8b done
#16 naming to docker.io/cloudflare-dev/towncontainerdo:241de740 done
#16 DONE 0.0s

 [33m1 warning found (use docker --debug to expand):
[0m - FromPlatformFlagConstDisallowed: FROM --platform flag should not use constant value "linux/arm64" (line 1)
âŽ” Container image(s) ready
âŽ” Starting local server...
[wrangler:info] Ready on http://localhost:9787
[gastown-worker] --> GET /health
[gastown-worker] <-- GET /health 200 (1ms)
[wrangler:info] GET /health 200 OK (990ms)
[gastown-worker] --> GET /health
[gastown-worker] <-- GET /health 200 (0ms)
[wrangler:info] GET /health 200 OK (1ms)
[gastown-worker] --> GET /nonexistent
[gastown-worker] <-- GET /nonexistent 404 (0ms)
[wrangler:info] GET /nonexistent 404 Not Found (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638186-22992/towns
[GastownUser.do] createTown: id=5122d9a9-d3be-4204-8e74-fb858a9a58db name=E2E-Town owner=e2e-user-1771638186-22992
[GastownUser.do] createTown: created town id=5122d9a9-d3be-4204-8e74-fb858a9a58db
[gastown-worker] <-- POST /api/users/e2e-user-1771638186-22992/towns 201 (4ms)
[wrangler:info] POST /api/users/e2e-user-1771638186-22992/towns 201 Created (4ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638186-22992/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771638186-22992/towns 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771638186-22992/towns 200 OK (2ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638186-22992/towns/5122d9a9-d3be-4204-8e74-fb858a9a58db
[gastown-worker] <-- GET /api/users/e2e-user-1771638186-22992/towns/5122d9a9-d3be-4204-8e74-fb858a9a58db 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771638186-22992/towns/5122d9a9-d3be-4204-8e74-fb858a9a58db 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638186-30203/towns
[GastownUser.do] createTown: id=49877045-2ceb-4b4e-a359-8a256afecbc8 name=Token-Town owner=e2e-user-1771638186-30203
[GastownUser.do] createTown: created town id=49877045-2ceb-4b4e-a359-8a256afecbc8
[gastown-worker] <-- POST /api/users/e2e-user-1771638186-30203/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638186-30203/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638186-30203/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638186-30203 town_id=49877045-2ceb-4b4e-a359-8a256afecbc8 name=token-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=49877045-2ceb-4b4e-a359-8a256afecbc8 name=token-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=f2357eb6-18ee-4023-b376-2de878e72365
[towns.handler] handleCreateRig: rig created id=f2357eb6-18ee-4023-b376-2de878e72365, now configuring Rig DO
[Town.do] configureRig: rigId=f2357eb6-18ee-4023-b376-2de878e72365 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=73f656923d6e8c0ee6f293b702491dab5c7b39c35fab989971d3ed08d84bdecd
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638186-30203/rigs 201 (325ms)
[wrangler:info] POST /api/users/e2e-user-1771638186-30203/rigs 201 Created (327ms)
[gastown-worker] --> GET /api/towns/49877045-2ceb-4b4e-a359-8a256afecbc8/config
[gastown-worker] <-- GET /api/towns/49877045-2ceb-4b4e-a359-8a256afecbc8/config 200 (0ms)
[wrangler:info] GET /api/towns/49877045-2ceb-4b4e-a359-8a256afecbc8/config 200 OK (1ms)
[gastown-worker] --> GET /api/towns/49877045-2ceb-4b4e-a359-8a256afecbc8/mayor/status
[gastown-worker] <-- GET /api/towns/49877045-2ceb-4b4e-a359-8a256afecbc8/mayor/status 200 (0ms)
[wrangler:info] GET /api/towns/49877045-2ceb-4b4e-a359-8a256afecbc8/mayor/status 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638188-31053/towns
[GastownUser.do] createTown: id=8431bec7-6a69-4483-92d6-037fa2cfe8e1 name=Mayor-Token-Town owner=e2e-user-1771638188-31053
[GastownUser.do] createTown: created town id=8431bec7-6a69-4483-92d6-037fa2cfe8e1
[gastown-worker] <-- POST /api/users/e2e-user-1771638188-31053/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638188-31053/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638188-31053/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638188-31053 town_id=8431bec7-6a69-4483-92d6-037fa2cfe8e1 name=mayor-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=8431bec7-6a69-4483-92d6-037fa2cfe8e1 name=mayor-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=5ae9c154-3da7-4219-9a00-2313657c60e7
[towns.handler] handleCreateRig: rig created id=5ae9c154-3da7-4219-9a00-2313657c60e7, now configuring Rig DO
[Town.do] configureRig: rigId=5ae9c154-3da7-4219-9a00-2313657c60e7 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=980eb33b5bb82277f9e8e0920376a0a31149364cf26fb123757d5713cd8378ca
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638188-31053/rigs 201 (331ms)
[wrangler:info] POST /api/users/e2e-user-1771638188-31053/rigs 201 Created (332ms)
[gastown-worker] --> GET /api/towns/8431bec7-6a69-4483-92d6-037fa2cfe8e1/config
[gastown-worker] <-- GET /api/towns/8431bec7-6a69-4483-92d6-037fa2cfe8e1/config 200 (0ms)
[wrangler:info] GET /api/towns/8431bec7-6a69-4483-92d6-037fa2cfe8e1/config 200 OK (1ms)
[gastown-worker] --> POST /api/towns/8431bec7-6a69-4483-92d6-037fa2cfe8e1/mayor/message
[mayor.handler] handleSendMayorMessage: townId=8431bec7-6a69-4483-92d6-037fa2cfe8e1 message="Hello from E2E test"
[Town.do] startAgentInContainer: agentId=2b336c59-55df-42c1-98c4-c6c128dfa28f role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[gastown-worker] <-- POST /api/towns/8431bec7-6a69-4483-92d6-037fa2cfe8e1/mayor/message 200 (5495ms)
[wrangler:info] POST /api/towns/8431bec7-6a69-4483-92d6-037fa2cfe8e1/mayor/message 200 OK (5496ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638199-8164/towns
[GastownUser.do] createTown: id=a05f115c-2649-4781-b115-1e8151c2da4c name=Single-Container-Town owner=e2e-user-1771638199-8164
[GastownUser.do] createTown: created town id=a05f115c-2649-4781-b115-1e8151c2da4c
[gastown-worker] <-- POST /api/users/e2e-user-1771638199-8164/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638199-8164/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638199-8164/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638199-8164 town_id=a05f115c-2649-4781-b115-1e8151c2da4c name=single-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=a05f115c-2649-4781-b115-1e8151c2da4c name=single-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=95765406-fee2-4ef9-9635-8787480385a0
[towns.handler] handleCreateRig: rig created id=95765406-fee2-4ef9-9635-8787480385a0, now configuring Rig DO
[Town.do] configureRig: rigId=95765406-fee2-4ef9-9635-8787480385a0 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=1a1e7a6d8403fec8b4d3041cc7e1cdab80c5754c072cbe91c29a069abba6dd46
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638199-8164/rigs 201 (333ms)
[wrangler:info] POST /api/users/e2e-user-1771638199-8164/rigs 201 Created (334ms)
[gastown-worker] --> POST /api/towns/a05f115c-2649-4781-b115-1e8151c2da4c/mayor/message
[mayor.handler] handleSendMayorMessage: townId=a05f115c-2649-4781-b115-1e8151c2da4c message="Test single container"
[Town.do] startAgentInContainer: agentId=251d2241-6130-4395-a550-c420cb2d3c4d role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=49877045-2ceb-4b4e-a359-8a256afecbc8
[Town.do] alarm: fired for town=8431bec7-6a69-4483-92d6-037fa2cfe8e1
[gastown-worker] <-- POST /api/towns/a05f115c-2649-4781-b115-1e8151c2da4c/mayor/message 200 (5936ms)
[wrangler:info] POST /api/towns/a05f115c-2649-4781-b115-1e8151c2da4c/mayor/message 200 OK (5937ms)
[Town.do] alarm: fired for town=a05f115c-2649-4781-b115-1e8151c2da4c
[gastown-worker] --> POST /api/towns/a05f115c-2649-4781-b115-1e8151c2da4c/mayor/message
[mayor.handler] handleSendMayorMessage: townId=a05f115c-2649-4781-b115-1e8151c2da4c message="Second message"
[gastown-worker] <-- POST /api/towns/a05f115c-2649-4781-b115-1e8151c2da4c/mayor/message 200 (16ms)
[wrangler:info] POST /api/towns/a05f115c-2649-4781-b115-1e8151c2da4c/mayor/message 200 OK (17ms)
[Town.do] alarm: fired for town=8431bec7-6a69-4483-92d6-037fa2cfe8e1
[gastown-worker] --> POST /api/users/e2e-user-1771638220-721/towns
[GastownUser.do] createTown: id=1d7263de-b359-4e40-aab5-12b08cdf91c0 name=Mayor-Status-Town owner=e2e-user-1771638220-721
[GastownUser.do] createTown: created town id=1d7263de-b359-4e40-aab5-12b08cdf91c0
[gastown-worker] <-- POST /api/users/e2e-user-1771638220-721/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638220-721/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638220-721/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638220-721 town_id=1d7263de-b359-4e40-aab5-12b08cdf91c0 name=status-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=1d7263de-b359-4e40-aab5-12b08cdf91c0 name=status-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=bdec2669-9fbb-4fa0-89b1-53d52481acb0
[towns.handler] handleCreateRig: rig created id=bdec2669-9fbb-4fa0-89b1-53d52481acb0, now configuring Rig DO
[Town.do] configureRig: rigId=bdec2669-9fbb-4fa0-89b1-53d52481acb0 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=1f2b1f4da0af93dcd263f41d801cba290349737b6bb8cfbdaeb230a4f0b1375b
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638220-721/rigs 201 (328ms)
[wrangler:info] POST /api/users/e2e-user-1771638220-721/rigs 201 Created (328ms)
[gastown-worker] --> GET /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/status
[gastown-worker] <-- GET /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/status 200 (0ms)
[wrangler:info] GET /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/status 200 OK (1ms)
[gastown-worker] --> POST /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/message
[mayor.handler] handleSendMayorMessage: townId=1d7263de-b359-4e40-aab5-12b08cdf91c0 message="Status test"
[Town.do] startAgentInContainer: agentId=5f91baad-36a3-40e4-b230-add5243e6ddc role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[gastown-worker] <-- POST /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/message 200 (5496ms)
[wrangler:info] POST /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/message 200 OK (5498ms)
[gastown-worker] --> GET /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/status
[gastown-worker] <-- GET /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/status 200 (0ms)
[wrangler:info] GET /api/towns/1d7263de-b359-4e40-aab5-12b08cdf91c0/mayor/status 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638228-9692/towns
[GastownUser.do] createTown: id=7747e795-cd0c-4f1d-b91e-fd02a4f52c17 name=List-Rigs-Town owner=e2e-user-1771638228-9692
[GastownUser.do] createTown: created town id=7747e795-cd0c-4f1d-b91e-fd02a4f52c17
[gastown-worker] <-- POST /api/users/e2e-user-1771638228-9692/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638228-9692/towns 201 Created (3ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638228-9692/towns/7747e795-cd0c-4f1d-b91e-fd02a4f52c17/rigs
[gastown-worker] <-- GET /api/users/e2e-user-1771638228-9692/towns/7747e795-cd0c-4f1d-b91e-fd02a4f52c17/rigs 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771638228-9692/towns/7747e795-cd0c-4f1d-b91e-fd02a4f52c17/rigs 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638228-9692/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638228-9692 town_id=7747e795-cd0c-4f1d-b91e-fd02a4f52c17 name=rig-a git_url=https://github.com/a/a.git
[GastownUser.do] createRig: town_id=7747e795-cd0c-4f1d-b91e-fd02a4f52c17 name=rig-a git_url=https://github.com/a/a.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=bc0dca73-aa21-4f56-97e6-38c7d377634a
[towns.handler] handleCreateRig: rig created id=bc0dca73-aa21-4f56-97e6-38c7d377634a, now configuring Rig DO
[Town.do] configureRig: rigId=bc0dca73-aa21-4f56-97e6-38c7d377634a hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=fb629bd6e4c9346bb4b9a1b7efdf5721deec5a951be25c812da8c1d895141cfe
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638228-9692/rigs 201 (327ms)
[wrangler:info] POST /api/users/e2e-user-1771638228-9692/rigs 201 Created (327ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638228-9692/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638228-9692 town_id=7747e795-cd0c-4f1d-b91e-fd02a4f52c17 name=rig-b git_url=https://github.com/b/b.git
[GastownUser.do] createRig: town_id=7747e795-cd0c-4f1d-b91e-fd02a4f52c17 name=rig-b git_url=https://github.com/b/b.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=6565ec22-6766-4b9e-8f63-1a56addc7b95
[towns.handler] handleCreateRig: rig created id=6565ec22-6766-4b9e-8f63-1a56addc7b95, now configuring Rig DO
[Town.do] configureRig: rigId=6565ec22-6766-4b9e-8f63-1a56addc7b95 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638228-9692/rigs 201 (5ms)
[wrangler:info] POST /api/users/e2e-user-1771638228-9692/rigs 201 Created (6ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638228-9692/towns/7747e795-cd0c-4f1d-b91e-fd02a4f52c17/rigs
[gastown-worker] <-- GET /api/users/e2e-user-1771638228-9692/towns/7747e795-cd0c-4f1d-b91e-fd02a4f52c17/rigs 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771638228-9692/towns/7747e795-cd0c-4f1d-b91e-fd02a4f52c17/rigs 200 OK (2ms)
[Town.do] alarm: fired for town=a05f115c-2649-4781-b115-1e8151c2da4c
[gastown-worker] --> POST /api/users/e2e-user-1771638229-14177/towns
[GastownUser.do] createTown: id=dba1fdea-8ce3-4840-ae42-12be590dfbf8 name=Config-Town owner=e2e-user-1771638229-14177
[GastownUser.do] createTown: created town id=dba1fdea-8ce3-4840-ae42-12be590dfbf8
[gastown-worker] <-- POST /api/users/e2e-user-1771638229-14177/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638229-14177/towns 201 Created (2ms)
[gastown-worker] --> GET /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config
[gastown-worker] <-- GET /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config 200 (2ms)
[wrangler:info] GET /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config 200 OK (3ms)
[gastown-worker] --> PATCH /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config
[Town.do] updateTownConfig: saved config with 1 env vars
[town-config.handler] handleUpdateTownConfig: town=dba1fdea-8ce3-4840-ae42-12be590dfbf8 updated config
[gastown-worker] <-- PATCH /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config 200 (1ms)
[wrangler:info] PATCH /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config 200 OK (2ms)
[gastown-worker] --> GET /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config
[gastown-worker] <-- GET /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config 200 (0ms)
[wrangler:info] GET /api/towns/dba1fdea-8ce3-4840-ae42-12be590dfbf8/config 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638229-18662/towns
[GastownUser.do] createTown: id=038b99a0-7f29-47f5-93c6-d0446884bc2b name=Delete-Town owner=e2e-user-1771638229-18662
[GastownUser.do] createTown: created town id=038b99a0-7f29-47f5-93c6-d0446884bc2b
[gastown-worker] <-- POST /api/users/e2e-user-1771638229-18662/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638229-18662/towns 201 Created (2ms)
[gastown-worker] --> DELETE /api/users/e2e-user-1771638229-18662/towns/038b99a0-7f29-47f5-93c6-d0446884bc2b
[Town.do] destroy: clearing all storage and alarms
[towns.handler] handleDeleteTown: Town DO destroyed for town 038b99a0-7f29-47f5-93c6-d0446884bc2b
[gastown-worker] <-- DELETE /api/users/e2e-user-1771638229-18662/towns/038b99a0-7f29-47f5-93c6-d0446884bc2b 200 (3ms)
[wrangler:info] DELETE /api/users/e2e-user-1771638229-18662/towns/038b99a0-7f29-47f5-93c6-d0446884bc2b 200 OK (4ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638229-18662/towns/038b99a0-7f29-47f5-93c6-d0446884bc2b
[gastown-worker] <-- GET /api/users/e2e-user-1771638229-18662/towns/038b99a0-7f29-47f5-93c6-d0446884bc2b 404 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771638229-18662/towns/038b99a0-7f29-47f5-93c6-d0446884bc2b 404 Not Found (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638229-18662/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771638229-18662/towns 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771638229-18662/towns 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638229-12244/towns
[GastownUser.do] createTown: id=955c482d-5aaf-4fce-bc96-c3ea38be3aba name=Del-Rig-Town owner=e2e-user-1771638229-12244
[GastownUser.do] createTown: created town id=955c482d-5aaf-4fce-bc96-c3ea38be3aba
[gastown-worker] <-- POST /api/users/e2e-user-1771638229-12244/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638229-12244/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638229-12244/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638229-12244 town_id=955c482d-5aaf-4fce-bc96-c3ea38be3aba name=del-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=955c482d-5aaf-4fce-bc96-c3ea38be3aba name=del-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=cb16da1a-4f86-45e6-b6aa-3057fc34d34b
[towns.handler] handleCreateRig: rig created id=cb16da1a-4f86-45e6-b6aa-3057fc34d34b, now configuring Rig DO
[Town.do] configureRig: rigId=cb16da1a-4f86-45e6-b6aa-3057fc34d34b hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=b976f289a9c84daab21862f389a1cb069ac19dd73d162ff9b164efe44a965185
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638229-12244/rigs 201 (333ms)
[wrangler:info] POST /api/users/e2e-user-1771638229-12244/rigs 201 Created (335ms)
[gastown-worker] --> DELETE /api/users/e2e-user-1771638229-12244/rigs/cb16da1a-4f86-45e6-b6aa-3057fc34d34b
[gastown-worker] <-- DELETE /api/users/e2e-user-1771638229-12244/rigs/cb16da1a-4f86-45e6-b6aa-3057fc34d34b 200 (1ms)
[wrangler:info] DELETE /api/users/e2e-user-1771638229-12244/rigs/cb16da1a-4f86-45e6-b6aa-3057fc34d34b 200 OK (2ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638229-12244/towns/955c482d-5aaf-4fce-bc96-c3ea38be3aba/rigs
[gastown-worker] <-- GET /api/users/e2e-user-1771638229-12244/towns/955c482d-5aaf-4fce-bc96-c3ea38be3aba/rigs 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771638229-12244/towns/955c482d-5aaf-4fce-bc96-c3ea38be3aba/rigs 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638230-10369/towns
[GastownUser.do] createTown: id=cc91d773-62d7-4a45-93c3-49e0818ac123 name=Bead-Town owner=e2e-user-1771638230-10369
[GastownUser.do] createTown: created town id=cc91d773-62d7-4a45-93c3-49e0818ac123
[gastown-worker] <-- POST /api/users/e2e-user-1771638230-10369/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638230-10369/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638230-10369/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638230-10369 town_id=cc91d773-62d7-4a45-93c3-49e0818ac123 name=bead-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=cc91d773-62d7-4a45-93c3-49e0818ac123 name=bead-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=69bdebda-10c2-4b2f-9793-045750c76c70
[towns.handler] handleCreateRig: rig created id=69bdebda-10c2-4b2f-9793-045750c76c70, now configuring Rig DO
[Town.do] configureRig: rigId=69bdebda-10c2-4b2f-9793-045750c76c70 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=d35eddba8ad0d52c06ed06d0543d93d691769671bec2b398caff58aad6a39db0
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638230-10369/rigs 201 (325ms)
[wrangler:info] POST /api/users/e2e-user-1771638230-10369/rigs 201 Created (326ms)
[gastown-worker] --> POST /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads
[rig-beads.handler] handleCreateBead: rigId=69bdebda-10c2-4b2f-9793-045750c76c70 type=issue title="E2E test bead" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"b9a99ef1-a9af-49ae-a1f1-143d2843283b","type":"issue","status":"open","title":"E2E test bead","body":"Test body","assignee_agent_id":null,"convoy_id":null,"molecule_id":null,"priority":"high","l
[gastown-worker] <-- POST /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads 201 (1ms)
[wrangler:info] POST /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads 201 Created (2ms)
[gastown-worker] --> GET /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads
[gastown-worker] <-- GET /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads 200 (1ms)
[wrangler:info] GET /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads 200 OK (1ms)
[gastown-worker] --> GET /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads/b9a99ef1-a9af-49ae-a1f1-143d2843283b
[gastown-worker] <-- GET /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads/b9a99ef1-a9af-49ae-a1f1-143d2843283b 200 (0ms)
[wrangler:info] GET /api/rigs/69bdebda-10c2-4b2f-9793-045750c76c70/beads/b9a99ef1-a9af-49ae-a1f1-143d2843283b 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638230-25757/towns
[GastownUser.do] createTown: id=7999428f-de88-411c-8280-c73cde41e270 name=Agent-Town owner=e2e-user-1771638230-25757
[GastownUser.do] createTown: created town id=7999428f-de88-411c-8280-c73cde41e270
[gastown-worker] <-- POST /api/users/e2e-user-1771638230-25757/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638230-25757/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638230-25757/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638230-25757 town_id=7999428f-de88-411c-8280-c73cde41e270 name=agent-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=7999428f-de88-411c-8280-c73cde41e270 name=agent-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=bbaf8126-8be0-47d7-8eb5-9e3e2705e50c
[towns.handler] handleCreateRig: rig created id=bbaf8126-8be0-47d7-8eb5-9e3e2705e50c, now configuring Rig DO
[Town.do] configureRig: rigId=bbaf8126-8be0-47d7-8eb5-9e3e2705e50c hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=af224a84c6f260a906c4dae95451c926e2302a0be8c7c1e9b32eedea5531e7dc
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638230-25757/rigs 201 (332ms)
[wrangler:info] POST /api/users/e2e-user-1771638230-25757/rigs 201 Created (332ms)
[gastown-worker] --> POST /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents
[gastown-worker] <-- POST /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents 201 (1ms)
[wrangler:info] POST /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents 201 Created (2ms)
[gastown-worker] --> GET /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents
[gastown-worker] <-- GET /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents 200 (1ms)
[wrangler:info] GET /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents 200 OK (2ms)
[gastown-worker] --> GET /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents/d98cc07f-993d-44d9-85c8-44a6b085b3fb
[gastown-worker] <-- GET /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents/d98cc07f-993d-44d9-85c8-44a6b085b3fb 200 (0ms)
[wrangler:info] GET /api/rigs/bbaf8126-8be0-47d7-8eb5-9e3e2705e50c/agents/d98cc07f-993d-44d9-85c8-44a6b085b3fb 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638231-11103/towns
[GastownUser.do] createTown: id=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55 name=Sling-Town owner=e2e-user-1771638231-11103
[GastownUser.do] createTown: created town id=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55
[gastown-worker] <-- POST /api/users/e2e-user-1771638231-11103/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638231-11103/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638231-11103/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638231-11103 town_id=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55 name=sling-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55 name=sling-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=35317779-a8e7-4228-b6a9-47b24466764e
[towns.handler] handleCreateRig: rig created id=35317779-a8e7-4228-b6a9-47b24466764e, now configuring Rig DO
[Town.do] configureRig: rigId=35317779-a8e7-4228-b6a9-47b24466764e hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638231-11103/rigs 201 (332ms)
[wrangler:info] POST /api/users/e2e-user-1771638231-11103/rigs 201 Created (332ms)
[gastown-worker] --> POST /api/rigs/35317779-a8e7-4228-b6a9-47b24466764e/sling
[rig-beads.handler] handleSlingBead: rigId=35317779-a8e7-4228-b6a9-47b24466764e title="Slung bead" metadata=undefined
[rig-beads.handler] handleSlingBead: completed, result={"bead":{"id":"36e816f4-6b1f-4c65-a1db-51d60b59dcdb","type":"issue","status":"in_progress","title":"Slung bead","body":"Do something","assignee_agent_id":"0fa4c2fa-3d4d-4eee-ab58-9eae5099c010","convoy_id":null,"molecule_id":null,"priority":"medium","labels":[],"metadata":{},"created_at":"2026-02-21T
[gastown-worker] <-- POST /api/rigs/35317779-a8e7-4228-b6a9-47b24466764e/sling 201 (2ms)
[wrangler:info] POST /api/rigs/35317779-a8e7-4228-b6a9-47b24466764e/sling 201 Created (2ms)
[gastown-worker] --> GET /api/rigs/35317779-a8e7-4228-b6a9-47b24466764e/agents/0fa4c2fa-3d4d-4eee-ab58-9eae5099c010
[gastown-worker] <-- GET /api/rigs/35317779-a8e7-4228-b6a9-47b24466764e/agents/0fa4c2fa-3d4d-4eee-ab58-9eae5099c010 200 (1ms)
[wrangler:info] GET /api/rigs/35317779-a8e7-4228-b6a9-47b24466764e/agents/0fa4c2fa-3d4d-4eee-ab58-9eae5099c010 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638231-22857/towns
[GastownUser.do] createTown: id=0684634d-3307-4d28-b256-9978fde02b3f name=Hook-Town owner=e2e-user-1771638231-22857
[GastownUser.do] createTown: created town id=0684634d-3307-4d28-b256-9978fde02b3f
[gastown-worker] <-- POST /api/users/e2e-user-1771638231-22857/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638231-22857/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638231-22857/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638231-22857 town_id=0684634d-3307-4d28-b256-9978fde02b3f name=hook-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=0684634d-3307-4d28-b256-9978fde02b3f name=hook-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=711e7db3-751b-48e3-90ca-fa40932dbca3
[towns.handler] handleCreateRig: rig created id=711e7db3-751b-48e3-90ca-fa40932dbca3, now configuring Rig DO
[Town.do] configureRig: rigId=711e7db3-751b-48e3-90ca-fa40932dbca3 hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=bac55e2c3f170fbb20bf20fc7c88303a6050ccd6eee069d27b0ec77086f9f681
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638231-22857/rigs 201 (332ms)
[wrangler:info] POST /api/users/e2e-user-1771638231-22857/rigs 201 Created (333ms)
[gastown-worker] --> POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents
[gastown-worker] <-- POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents 201 (1ms)
[wrangler:info] POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents 201 Created (1ms)
[gastown-worker] --> POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/beads
[rig-beads.handler] handleCreateBead: rigId=711e7db3-751b-48e3-90ca-fa40932dbca3 type=issue title="Hook bead" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"0130cea1-0a1d-430a-9f03-61ed61aa582a","type":"issue","status":"open","title":"Hook bead","body":null,"assignee_agent_id":null,"convoy_id":null,"molecule_id":null,"priority":"medium","labels":[]
[gastown-worker] <-- POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/beads 201 (1ms)
[wrangler:info] POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/beads 201 Created (2ms)
[gastown-worker] --> POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759/hook
[rig-agents.handler] handleHookBead: rigId=711e7db3-751b-48e3-90ca-fa40932dbca3 agentId=4279a464-b1a4-4109-b179-d88b01086759 beadId=0130cea1-0a1d-430a-9f03-61ed61aa582a
[rig-agents.handler] handleHookBead: hooked successfully
[gastown-worker] <-- POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759/hook 200 (1ms)
[wrangler:info] POST /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759/hook 200 OK (1ms)
[gastown-worker] --> GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759
[gastown-worker] <-- GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759 200 (0ms)
[wrangler:info] GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759 200 OK (1ms)
[gastown-worker] --> GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/beads/0130cea1-0a1d-430a-9f03-61ed61aa582a
[gastown-worker] <-- GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/beads/0130cea1-0a1d-430a-9f03-61ed61aa582a 200 (0ms)
[wrangler:info] GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/beads/0130cea1-0a1d-430a-9f03-61ed61aa582a 200 OK (1ms)
[gastown-worker] --> DELETE /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759/hook
[gastown-worker] <-- DELETE /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759/hook 200 (1ms)
[wrangler:info] DELETE /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759/hook 200 OK (2ms)
[gastown-worker] --> GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759
[gastown-worker] <-- GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759 200 (0ms)
[wrangler:info] GET /api/rigs/711e7db3-751b-48e3-90ca-fa40932dbca3/agents/4279a464-b1a4-4109-b179-d88b01086759 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638232-12747/towns
[GastownUser.do] createTown: id=40765df1-ad07-4431-82ed-121df055b78d name=Mail-Town owner=e2e-user-1771638232-12747
[GastownUser.do] createTown: created town id=40765df1-ad07-4431-82ed-121df055b78d
[gastown-worker] <-- POST /api/users/e2e-user-1771638232-12747/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638232-12747/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638232-12747/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638232-12747 town_id=40765df1-ad07-4431-82ed-121df055b78d name=mail-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=40765df1-ad07-4431-82ed-121df055b78d name=mail-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=373301ff-b252-458f-9a88-8a0a0f32826c
[towns.handler] handleCreateRig: rig created id=373301ff-b252-458f-9a88-8a0a0f32826c, now configuring Rig DO
[Town.do] configureRig: rigId=373301ff-b252-458f-9a88-8a0a0f32826c hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=e22c223fc94253eb04bb54c9f001016a98e296612148da23d85d5fae5bc1b920
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638232-12747/rigs 201 (332ms)
[wrangler:info] POST /api/users/e2e-user-1771638232-12747/rigs 201 Created (333ms)
[gastown-worker] --> POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents
[gastown-worker] <-- POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents 201 (0ms)
[wrangler:info] POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents 201 Created (1ms)
[gastown-worker] --> POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents
[gastown-worker] <-- POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents 201 (2ms)
[wrangler:info] POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents 201 Created (3ms)
[gastown-worker] --> POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/mail
[gastown-worker] <-- POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/mail 201 (1ms)
[wrangler:info] POST /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/mail 201 Created (1ms)
[gastown-worker] --> GET /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents/3a8eb773-0684-4069-ab0d-1f36f6fdd80d/mail
[gastown-worker] <-- GET /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents/3a8eb773-0684-4069-ab0d-1f36f6fdd80d/mail 200 (1ms)
[wrangler:info] GET /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents/3a8eb773-0684-4069-ab0d-1f36f6fdd80d/mail 200 OK (1ms)
[gastown-worker] --> GET /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents/3a8eb773-0684-4069-ab0d-1f36f6fdd80d/mail
[gastown-worker] <-- GET /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents/3a8eb773-0684-4069-ab0d-1f36f6fdd80d/mail 200 (0ms)
[wrangler:info] GET /api/rigs/373301ff-b252-458f-9a88-8a0a0f32826c/agents/3a8eb773-0684-4069-ab0d-1f36f6fdd80d/mail 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638232-29952/towns
[GastownUser.do] createTown: id=220f14f9-fe7a-489d-81cc-ac90acd64c69 name=Events-Town owner=e2e-user-1771638232-29952
[GastownUser.do] createTown: created town id=220f14f9-fe7a-489d-81cc-ac90acd64c69
[gastown-worker] <-- POST /api/users/e2e-user-1771638232-29952/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638232-29952/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638232-29952/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638232-29952 town_id=220f14f9-fe7a-489d-81cc-ac90acd64c69 name=ev-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=220f14f9-fe7a-489d-81cc-ac90acd64c69 name=ev-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=58f0df13-b7ac-44d8-a269-e792646f0f6a
[towns.handler] handleCreateRig: rig created id=58f0df13-b7ac-44d8-a269-e792646f0f6a, now configuring Rig DO
[Town.do] configureRig: rigId=58f0df13-b7ac-44d8-a269-e792646f0f6a hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=e6b42820533897410c107c2acf6f899d06ad68f98c7bb3ffbb6c8d32f851aa32
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638232-29952/rigs 201 (330ms)
[wrangler:info] POST /api/users/e2e-user-1771638232-29952/rigs 201 Created (332ms)
[gastown-worker] --> POST /api/rigs/58f0df13-b7ac-44d8-a269-e792646f0f6a/sling
[rig-beads.handler] handleSlingBead: rigId=58f0df13-b7ac-44d8-a269-e792646f0f6a title="Event bead" metadata=undefined
[rig-beads.handler] handleSlingBead: completed, result={"bead":{"id":"5dae4917-cf71-461b-b5d0-b6ddc77787ab","type":"issue","status":"in_progress","title":"Event bead","body":null,"assignee_agent_id":"622a1102-d883-4f35-b425-51c359794b64","convoy_id":null,"molecule_id":null,"priority":"medium","labels":[],"metadata":{},"created_at":"2026-02-21T01:43:53.0
[gastown-worker] <-- POST /api/rigs/58f0df13-b7ac-44d8-a269-e792646f0f6a/sling 201 (1ms)
[wrangler:info] POST /api/rigs/58f0df13-b7ac-44d8-a269-e792646f0f6a/sling 201 Created (2ms)
[gastown-worker] --> GET /api/rigs/58f0df13-b7ac-44d8-a269-e792646f0f6a/events
[gastown-worker] <-- GET /api/rigs/58f0df13-b7ac-44d8-a269-e792646f0f6a/events 200 (1ms)
[wrangler:info] GET /api/rigs/58f0df13-b7ac-44d8-a269-e792646f0f6a/events 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638233-30803/towns
[GastownUser.do] createTown: id=621dd6fb-395f-4f19-a70d-64a58407ce9b name=Town-Alpha owner=e2e-user-1771638233-30803
[GastownUser.do] createTown: created town id=621dd6fb-395f-4f19-a70d-64a58407ce9b
[gastown-worker] <-- POST /api/users/e2e-user-1771638233-30803/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638233-30803/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638233-30803/towns
[GastownUser.do] createTown: id=402c383d-067c-490e-aec8-286cab49704a name=Town-Beta owner=e2e-user-1771638233-30803
[GastownUser.do] createTown: created town id=402c383d-067c-490e-aec8-286cab49704a
[gastown-worker] <-- POST /api/users/e2e-user-1771638233-30803/towns 201 (0ms)
[wrangler:info] POST /api/users/e2e-user-1771638233-30803/towns 201 Created (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638233-30803/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771638233-30803/towns 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771638233-30803/towns 200 OK (1ms)
[gastown-worker] --> DELETE /api/users/e2e-user-1771638233-30803/towns/621dd6fb-395f-4f19-a70d-64a58407ce9b
[Town.do] destroy: clearing all storage and alarms
[towns.handler] handleDeleteTown: Town DO destroyed for town 621dd6fb-395f-4f19-a70d-64a58407ce9b
[gastown-worker] <-- DELETE /api/users/e2e-user-1771638233-30803/towns/621dd6fb-395f-4f19-a70d-64a58407ce9b 200 (3ms)
[wrangler:info] DELETE /api/users/e2e-user-1771638233-30803/towns/621dd6fb-395f-4f19-a70d-64a58407ce9b 200 OK (5ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638233-30803/towns/402c383d-067c-490e-aec8-286cab49704a
[gastown-worker] <-- GET /api/users/e2e-user-1771638233-30803/towns/402c383d-067c-490e-aec8-286cab49704a 200 (1ms)
[wrangler:info] GET /api/users/e2e-user-1771638233-30803/towns/402c383d-067c-490e-aec8-286cab49704a 200 OK (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638233-30803/towns
[gastown-worker] <-- GET /api/users/e2e-user-1771638233-30803/towns 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771638233-30803/towns 200 OK (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638233-5246/towns
[GastownUser.do] createTown: id=aacab661-7796-4251-a87e-716ed4fa029e name=EnvVar-Town owner=e2e-user-1771638233-5246
[GastownUser.do] createTown: created town id=aacab661-7796-4251-a87e-716ed4fa029e
[gastown-worker] <-- POST /api/users/e2e-user-1771638233-5246/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638233-5246/towns 201 Created (3ms)
[gastown-worker] --> PATCH /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/config
[Town.do] updateTownConfig: saved config with 2 env vars
[town-config.handler] handleUpdateTownConfig: town=aacab661-7796-4251-a87e-716ed4fa029e updated config
[gastown-worker] <-- PATCH /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/config 200 (4ms)
[wrangler:info] PATCH /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/config 200 OK (5ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638233-5246/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638233-5246 town_id=aacab661-7796-4251-a87e-716ed4fa029e name=envvar-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=aacab661-7796-4251-a87e-716ed4fa029e name=envvar-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=bc4f8779-cd6e-4a81-97a7-961c04fa81eb
[towns.handler] handleCreateRig: rig created id=bc4f8779-cd6e-4a81-97a7-961c04fa81eb, now configuring Rig DO
[Town.do] configureRig: rigId=bc4f8779-cd6e-4a81-97a7-961c04fa81eb hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 2 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[Town.do] alarm: fired for town=8431bec7-6a69-4483-92d6-037fa2cfe8e1
Port 8080 is ready
[TownContainer.do] container started for DO id=0e2aac152351b3433fb6a3909469e7d867835e460fada41e1a6367f53cfdf59d
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638233-5246/rigs 201 (324ms)
[wrangler:info] POST /api/users/e2e-user-1771638233-5246/rigs 201 Created (324ms)
[gastown-worker] --> POST /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/mayor/message
[mayor.handler] handleSendMayorMessage: townId=aacab661-7796-4251-a87e-716ed4fa029e message="env var test"
[Town.do] startAgentInContainer: agentId=08069c01-8526-4956-a717-8f36a06a2120 role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=1d7263de-b359-4e40-aab5-12b08cdf91c0
[gastown-worker] <-- POST /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/mayor/message 200 (6542ms)
[wrangler:info] POST /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/mayor/message 200 OK (6543ms)
[gastown-worker] --> GET /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/config
[gastown-worker] <-- GET /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/config 200 (0ms)
[wrangler:info] GET /api/towns/aacab661-7796-4251-a87e-716ed4fa029e/config 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638243-1496/towns
[GastownUser.do] createTown: id=954a0ab9-bed9-435e-a1b6-7e7e5c12b6da name=Escalation-Town owner=e2e-user-1771638243-1496
[GastownUser.do] createTown: created town id=954a0ab9-bed9-435e-a1b6-7e7e5c12b6da
[gastown-worker] <-- POST /api/users/e2e-user-1771638243-1496/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638243-1496/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638243-1496/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638243-1496 town_id=954a0ab9-bed9-435e-a1b6-7e7e5c12b6da name=esc-rig git_url=https://github.com/t/r.git
[GastownUser.do] createRig: town_id=954a0ab9-bed9-435e-a1b6-7e7e5c12b6da name=esc-rig git_url=https://github.com/t/r.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d
[towns.handler] handleCreateRig: rig created id=a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d, now configuring Rig DO
[Town.do] configureRig: rigId=a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=29607c881838326ba108d7b6312d92d858b48683a75bc5b99cde1d91c9c13471
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638243-1496/rigs 201 (333ms)
[wrangler:info] POST /api/users/e2e-user-1771638243-1496/rigs 201 Created (333ms)
[gastown-worker] --> POST /api/rigs/a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d/escalations
[gastown-worker] <-- POST /api/rigs/a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d/escalations 201 (1ms)
[wrangler:info] POST /api/rigs/a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d/escalations 201 Created (1ms)
[gastown-worker] --> GET /api/towns/954a0ab9-bed9-435e-a1b6-7e7e5c12b6da/escalations
[gastown-worker] <-- GET /api/towns/954a0ab9-bed9-435e-a1b6-7e7e5c12b6da/escalations 200 (0ms)
[wrangler:info] GET /api/towns/954a0ab9-bed9-435e-a1b6-7e7e5c12b6da/escalations 200 OK (1ms)
[gastown-worker] --> GET /api/rigs/a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d/beads
[gastown-worker] <-- GET /api/rigs/a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d/beads 200 (0ms)
[wrangler:info] GET /api/rigs/a4c01a52-2d7c-4b3f-96ff-eb6ef23c012d/beads 200 OK (1ms)
[Town.do] alarm: fired for town=7747e795-cd0c-4f1d-b91e-fd02a4f52c17
[TownContainer.do] container stopped: exitCode=137 reason=exit id=bac55e2c3f170fbb20bf20fc7c88303a6050ccd6eee069d27b0ec77086f9f681
[TownContainer.do] container stopped: exitCode=137 reason=exit id=e22c223fc94253eb04bb54c9f001016a98e296612148da23d85d5fae5bc1b920
[TownContainer.do] container stopped: exitCode=137 reason=exit id=af224a84c6f260a906c4dae95451c926e2302a0be8c7c1e9b32eedea5531e7dc
[TownContainer.do] container stopped: exitCode=137 reason=exit id=73f656923d6e8c0ee6f293b702491dab5c7b39c35fab989971d3ed08d84bdecd
[TownContainer.do] container stopped: exitCode=137 reason=exit id=d35eddba8ad0d52c06ed06d0543d93d691769671bec2b398caff58aad6a39db0
[TownContainer.do] container stopped: exitCode=137 reason=exit id=e6b42820533897410c107c2acf6f899d06ad68f98c7bb3ffbb6c8d32f851aa32
[Town.do] alarm: fired for town=a05f115c-2649-4781-b115-1e8151c2da4c
[TownContainer.do] container stopped: exitCode=137 reason=exit id=b976f289a9c84daab21862f389a1cb069ac19dd73d162ff9b164efe44a965185
[TownContainer.do] container stopped: exitCode=137 reason=exit id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c
[TownContainer.do] container stopped: exitCode=137 reason=exit id=1f2b1f4da0af93dcd263f41d801cba290349737b6bb8cfbdaeb230a4f0b1375b
[TownContainer.do] container stopped: exitCode=137 reason=exit id=fb629bd6e4c9346bb4b9a1b7efdf5721deec5a951be25c812da8c1d895141cfe
[Town.do] alarm: fired for town=955c482d-5aaf-4fce-bc96-c3ea38be3aba
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mError proxying request to container fb629bd6e4c9346bb4b9a1b7efdf5721deec5a951be25c812da8c1d895141cfe: Error: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.[0m

      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:717:19)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) {
    retryable: true
  }


[TownContainer.do] container stopped: exitCode=137 reason=exit id=29607c881838326ba108d7b6312d92d858b48683a75bc5b99cde1d91c9c13471
[TownContainer.do] container stopped: exitCode=137 reason=exit id=1a1e7a6d8403fec8b4d3041cc7e1cdab80c5754c072cbe91c29a069abba6dd46
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mError proxying request to container 1a1e7a6d8403fec8b4d3041cc7e1cdab80c5754c072cbe91c29a069abba6dd46: Error: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.[0m

      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:717:19)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) {
    retryable: true
  }


Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[TownContainer.do] container stopped: exitCode=137 reason=exit id=0e2aac152351b3433fb6a3909469e7d867835e460fada41e1a6367f53cfdf59d
[TownContainer.do] container stopped: exitCode=137 reason=exit id=980eb33b5bb82277f9e8e0920376a0a31149364cf26fb123757d5713cd8378ca
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=1a1e7a6d8403fec8b4d3041cc7e1cdab80c5754c072cbe91c29a069abba6dd46


[Town.do] alarm: fired for town=cc91d773-62d7-4a45-93c3-49e0818ac123
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=d35eddba8ad0d52c06ed06d0543d93d691769671bec2b398caff58aad6a39db0


[Town.do] alarm: fired for town=7999428f-de88-411c-8280-c73cde41e270
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=af224a84c6f260a906c4dae95451c926e2302a0be8c7c1e9b32eedea5531e7dc


[Town.do] alarm: fired for town=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c


[Town.do] startAgentInContainer: agentId=0fa4c2fa-3d4d-4eee-ab58-9eae5099c010 role=polecat name=Toast
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=0684634d-3307-4d28-b256-9978fde02b3f
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[gastown-worker] --> POST /api/users/e2e-user-1771638243-24636/towns
[GastownUser.do] createTown: id=ba0f267f-48c7-4ecc-a610-0e35cd92ade5 name=Full-E2E-Town owner=e2e-user-1771638243-24636
[GastownUser.do] createTown: created town id=ba0f267f-48c7-4ecc-a610-0e35cd92ade5
[gastown-worker] <-- POST /api/users/e2e-user-1771638243-24636/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638243-24636/towns 201 Created (4ms)
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=bac55e2c3f170fbb20bf20fc7c88303a6050ccd6eee069d27b0ec77086f9f681


[gastown-worker] --> PATCH /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/config
[Town.do] updateTownConfig: saved config with 1 env vars
[town-config.handler] handleUpdateTownConfig: town=ba0f267f-48c7-4ecc-a610-0e35cd92ade5 updated config
[gastown-worker] <-- PATCH /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/config 200 (3ms)
[wrangler:info] PATCH /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/config 200 OK (4ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638243-24636/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638243-24636 town_id=ba0f267f-48c7-4ecc-a610-0e35cd92ade5 name=e2e-rig git_url=https://github.com/test/e2e.git
[GastownUser.do] createRig: town_id=ba0f267f-48c7-4ecc-a610-0e35cd92ade5 name=e2e-rig git_url=https://github.com/test/e2e.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=64831ae5-a023-4874-b0a9-049ccd81f178
[towns.handler] handleCreateRig: rig created id=64831ae5-a023-4874-b0a9-049ccd81f178, now configuring Rig DO
[Town.do] configureRig: rigId=64831ae5-a023-4874-b0a9-049ccd81f178 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 1 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[Town.do] alarm: fired for town=40765df1-ad07-4431-82ed-121df055b78d
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=fce82d4b8e9725c29936059d15a879d2b7193bb032a6aea15b69baf47c8fdfc5
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638243-24636/rigs 201 (319ms)
[wrangler:info] POST /api/users/e2e-user-1771638243-24636/rigs 201 Created (319ms)
[gastown-worker] --> GET /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/config
[gastown-worker] <-- GET /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/config 200 (1ms)
[wrangler:info] GET /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/config 200 OK (1ms)
[gastown-worker] --> POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads
[rig-beads.handler] handleCreateBead: rigId=64831ae5-a023-4874-b0a9-049ccd81f178 type=issue title="Build login page" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"edea8af9-d0c4-487f-af9e-da9830ad68e4","type":"issue","status":"open","title":"Build login page","body":null,"assignee_agent_id":null,"convoy_id":null,"molecule_id":null,"priority":"high","label
[gastown-worker] <-- POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads 201 (0ms)
[wrangler:info] POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads 201 Created (2ms)
[gastown-worker] --> POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads
[rig-beads.handler] handleCreateBead: rigId=64831ae5-a023-4874-b0a9-049ccd81f178 type=issue title="Fix sidebar CSS" assignee=none
[rig-beads.handler] handleCreateBead: created bead {"id":"bea8fe3f-338c-4d97-8804-84d712ef5b79","type":"issue","status":"open","title":"Fix sidebar CSS","body":null,"assignee_agent_id":null,"convoy_id":null,"molecule_id":null,"priority":"medium","labe
[gastown-worker] <-- POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads 201 (1ms)
[wrangler:info] POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads 201 Created (2ms)
[gastown-worker] --> POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents
[gastown-worker] <-- POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents 201 (1ms)
[wrangler:info] POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents 201 Created (2ms)
[gastown-worker] --> POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents/aef94150-7819-4597-9904-9df43bb136a3/hook
[rig-agents.handler] handleHookBead: rigId=64831ae5-a023-4874-b0a9-049ccd81f178 agentId=aef94150-7819-4597-9904-9df43bb136a3 beadId=edea8af9-d0c4-487f-af9e-da9830ad68e4
[rig-agents.handler] handleHookBead: hooked successfully
[gastown-worker] <-- POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents/aef94150-7819-4597-9904-9df43bb136a3/hook 200 (1ms)
[wrangler:info] POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents/aef94150-7819-4597-9904-9df43bb136a3/hook 200 OK (1ms)
[gastown-worker] --> GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads/edea8af9-d0c4-487f-af9e-da9830ad68e4
[gastown-worker] <-- GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads/edea8af9-d0c4-487f-af9e-da9830ad68e4 200 (0ms)
[wrangler:info] GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/beads/edea8af9-d0c4-487f-af9e-da9830ad68e4 200 OK (2ms)
[gastown-worker] --> POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/sling
[rig-beads.handler] handleSlingBead: rigId=64831ae5-a023-4874-b0a9-049ccd81f178 title="Urgent hotfix" metadata=undefined
[rig-beads.handler] handleSlingBead: completed, result={"bead":{"id":"20765a41-a689-4e1d-9836-87ce762ee287","type":"issue","status":"in_progress","title":"Urgent hotfix","body":null,"assignee_agent_id":"975585b5-2885-4513-aeb0-c5ef3e1314ce","convoy_id":null,"molecule_id":null,"priority":"medium","labels":[],"metadata":{},"created_at":"2026-02-21T01:44:0
[gastown-worker] <-- POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/sling 201 (1ms)
[wrangler:info] POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/sling 201 Created (1ms)
[gastown-worker] --> POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/mail
[gastown-worker] <-- POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/mail 201 (0ms)
[wrangler:info] POST /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/mail 201 Created (2ms)
[gastown-worker] --> GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/events
[gastown-worker] <-- GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/events 200 (0ms)
[wrangler:info] GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/events 200 OK (1ms)
[gastown-worker] --> POST /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/mayor/message
[mayor.handler] handleSendMayorMessage: townId=ba0f267f-48c7-4ecc-a610-0e35cd92ade5 message="What is the status of our project?"
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=e22c223fc94253eb04bb54c9f001016a98e296612148da23d85d5fae5bc1b920


[Town.do] startAgentInContainer: agentId=fb3262d1-c001-4360-843a-e9cc7bfd22b2 role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=220f14f9-fe7a-489d-81cc-ac90acd64c69
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=e6b42820533897410c107c2acf6f899d06ad68f98c7bb3ffbb6c8d32f851aa32


[Town.do] startAgentInContainer: agentId=622a1102-d883-4f35-b425-51c359794b64 role=polecat name=Toast
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


Port 8080 is ready
[TownContainer.do] container started for DO id=e6b42820533897410c107c2acf6f899d06ad68f98c7bb3ffbb6c8d32f851aa32
[Town.do] alarm: fired for town=aacab661-7796-4251-a87e-716ed4fa029e
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[Town.do] alarm: fired for town=8431bec7-6a69-4483-92d6-037fa2cfe8e1
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=0e2aac152351b3433fb6a3909469e7d867835e460fada41e1a6367f53cfdf59d


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=980eb33b5bb82277f9e8e0920376a0a31149364cf26fb123757d5713cd8378ca


Port 8080 is ready
[TownContainer.do] container started for DO id=980eb33b5bb82277f9e8e0920376a0a31149364cf26fb123757d5713cd8378ca
[TownContainer.do] container stopped: exitCode=137 reason=exit id=e6b42820533897410c107c2acf6f899d06ad68f98c7bb3ffbb6c8d32f851aa32
[TownContainer.do] container stopped: exitCode=137 reason=exit id=980eb33b5bb82277f9e8e0920376a0a31149364cf26fb123757d5713cd8378ca
[Town.do] alarm: fired for town=1d7263de-b359-4e40-aab5-12b08cdf91c0
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=1f2b1f4da0af93dcd263f41d801cba290349737b6bb8cfbdaeb230a4f0b1375b


Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[Town.do] startAgentInContainer: error response: Failed to start container: The operation was aborted[0m


[gastown-worker] <-- POST /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/mayor/message 200 (5539ms)
[wrangler:info] POST /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/mayor/message 200 OK (5540ms)
Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=0e2aac152351b3433fb6a3909469e7d867835e460fada41e1a6367f53cfdf59d


Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=1f2b1f4da0af93dcd263f41d801cba290349737b6bb8cfbdaeb230a4f0b1375b


[Town.do] alarm: fired for town=954a0ab9-bed9-435e-a1b6-7e7e5c12b6da
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=29607c881838326ba108d7b6312d92d858b48683a75bc5b99cde1d91c9c13471


[Town.do] alarm: fired for town=a05f115c-2649-4781-b115-1e8151c2da4c
Port 8080 is ready
[TownContainer.do] container started for DO id=1a1e7a6d8403fec8b4d3041cc7e1cdab80c5754c072cbe91c29a069abba6dd46
[TownContainer.do] container stopped: exitCode=137 reason=exit id=1a1e7a6d8403fec8b4d3041cc7e1cdab80c5754c072cbe91c29a069abba6dd46
[gastown-worker] --> GET /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/mayor/status
[gastown-worker] <-- GET /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/mayor/status 200 (0ms)
[wrangler:info] GET /api/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/mayor/status 200 OK (1ms)
[gastown-worker] --> GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents
[gastown-worker] <-- GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents 200 (0ms)
[wrangler:info] GET /api/rigs/64831ae5-a023-4874-b0a9-049ccd81f178/agents 200 OK (1ms)
[gastown-worker] --> GET /api/users/e2e-user-1771638243-24636/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/events
[gastown-worker] <-- GET /api/users/e2e-user-1771638243-24636/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/events 200 (0ms)
[wrangler:info] GET /api/users/e2e-user-1771638243-24636/towns/ba0f267f-48c7-4ecc-a610-0e35cd92ade5/events 200 OK (1ms)
[Town.do] alarm: fired for town=ba0f267f-48c7-4ecc-a610-0e35cd92ade5
[TownContainer.do] container stopped: exitCode=137 reason=exit id=fce82d4b8e9725c29936059d15a879d2b7193bb032a6aea15b69baf47c8fdfc5
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mError proxying request to container fce82d4b8e9725c29936059d15a879d2b7193bb032a6aea15b69baf47c8fdfc5: Error: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.[0m

      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:717:19)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) {
    retryable: true
  }


[Town.do] startAgentInContainer: agentId=aef94150-7819-4597-9904-9df43bb136a3 role=polecat name=E2E-Polecat
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=fce82d4b8e9725c29936059d15a879d2b7193bb032a6aea15b69baf47c8fdfc5


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[Town.do] startAgentInContainer: error response: Failed to start container: Container exited with unexpected exit code: 137[0m


[Town.do] startAgentInContainer: agentId=975585b5-2885-4513-aeb0-c5ef3e1314ce role=polecat name=Toast
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


Port 8080 is ready
[TownContainer.do] container started for DO id=fce82d4b8e9725c29936059d15a879d2b7193bb032a6aea15b69baf47c8fdfc5
[TownContainer.do] container stopped: exitCode=137 reason=exit id=fce82d4b8e9725c29936059d15a879d2b7193bb032a6aea15b69baf47c8fdfc5
[gastown-worker] --> POST /api/users/e2e-user-1771638261-24772/towns
[GastownUser.do] createTown: id=d22e87f5-ccba-479e-8ee9-cc13f83e09b7 name=Deep-Config-Town owner=e2e-user-1771638261-24772
[GastownUser.do] createTown: created town id=d22e87f5-ccba-479e-8ee9-cc13f83e09b7
[gastown-worker] <-- POST /api/users/e2e-user-1771638261-24772/towns 201 (3ms)
[wrangler:info] POST /api/users/e2e-user-1771638261-24772/towns 201 Created (4ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638261-24772/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638261-24772 town_id=d22e87f5-ccba-479e-8ee9-cc13f83e09b7 name=deep-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=d22e87f5-ccba-479e-8ee9-cc13f83e09b7 name=deep-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=60f89c39-b5e2-411a-9932-ad9cd67f4ceb
[towns.handler] handleCreateRig: rig created id=60f89c39-b5e2-411a-9932-ad9cd67f4ceb, now configuring Rig DO
[Town.do] configureRig: rigId=60f89c39-b5e2-411a-9932-ad9cd67f4ceb hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=5b548d1839911ea425461c18137a492ec35673a00cde10a3bdf319586dcb205f
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638261-24772/rigs 201 (329ms)
[wrangler:info] POST /api/users/e2e-user-1771638261-24772/rigs 201 Created (330ms)
[gastown-worker] --> GET /api/towns/d22e87f5-ccba-479e-8ee9-cc13f83e09b7/config
[gastown-worker] <-- GET /api/towns/d22e87f5-ccba-479e-8ee9-cc13f83e09b7/config 200 (0ms)
[wrangler:info] GET /api/towns/d22e87f5-ccba-479e-8ee9-cc13f83e09b7/config 200 OK (1ms)
[gastown-worker] --> POST /api/towns/d22e87f5-ccba-479e-8ee9-cc13f83e09b7/mayor/message
[mayor.handler] handleSendMayorMessage: townId=d22e87f5-ccba-479e-8ee9-cc13f83e09b7 message="Deep config test"
[Town.do] startAgentInContainer: agentId=8f0490c1-70fb-4e45-9a2b-2eeb1fc4b0c0 role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c
[Town.do] startAgentInContainer: agentId=0fa4c2fa-3d4d-4eee-ab58-9eae5099c010 role=polecat name=Toast
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[Town.do] startAgentInContainer: error response: {"error":"git clone --no-checkout --branch main https://github.com/t/r.git /workspace/rigs/35317779-a8e7-4228-b6a9-47b24466764e/repo failed: Cloning into '/workspace/rigs/35317779-a8e7-4228-b6a9-47b24466764e/repo'...\nfatal: could not read Username for 'https://github.com': No such device or address\n"}[0m


[Town.do] alarm: fired for town=aacab661-7796-4251-a87e-716ed4fa029e
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=0e2aac152351b3433fb6a3909469e7d867835e460fada41e1a6367f53cfdf59d


Port 8080 is ready
[TownContainer.do] container started for DO id=0e2aac152351b3433fb6a3909469e7d867835e460fada41e1a6367f53cfdf59d
[TownContainer.do] container stopped: exitCode=137 reason=exit id=0e2aac152351b3433fb6a3909469e7d867835e460fada41e1a6367f53cfdf59d
[gastown-worker] <-- POST /api/towns/d22e87f5-ccba-479e-8ee9-cc13f83e09b7/mayor/message 200 (5581ms)
[wrangler:info] POST /api/towns/d22e87f5-ccba-479e-8ee9-cc13f83e09b7/mayor/message 200 OK (5581ms)
[Town.do] alarm: fired for town=1d7263de-b359-4e40-aab5-12b08cdf91c0
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=1f2b1f4da0af93dcd263f41d801cba290349737b6bb8cfbdaeb230a4f0b1375b


Port 8080 is ready
[TownContainer.do] container started for DO id=1f2b1f4da0af93dcd263f41d801cba290349737b6bb8cfbdaeb230a4f0b1375b
[TownContainer.do] container stopped: exitCode=137 reason=exit id=1f2b1f4da0af93dcd263f41d801cba290349737b6bb8cfbdaeb230a4f0b1375b
[Town.do] alarm: fired for town=d22e87f5-ccba-479e-8ee9-cc13f83e09b7
[Town.do] alarm: fired for town=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55
[Town.do] startAgentInContainer: agentId=0fa4c2fa-3d4d-4eee-ab58-9eae5099c010 role=polecat name=Toast
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[Town.do] startAgentInContainer: error response: {"error":"git clone --no-checkout --branch main https://github.com/t/r.git /workspace/rigs/35317779-a8e7-4228-b6a9-47b24466764e/repo failed: Cloning into '/workspace/rigs/35317779-a8e7-4228-b6a9-47b24466764e/repo'...\nfatal: could not read Username for 'https://github.com': No such device or address\n"}[0m


[TownContainer.do] container stopped: exitCode=137 reason=exit id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c
[TownContainer.do] container stopped: exitCode=137 reason=exit id=5b548d1839911ea425461c18137a492ec35673a00cde10a3bdf319586dcb205f
[gastown-worker] --> POST /api/users/e2e-user-1771638290-5769/towns
[GastownUser.do] createTown: id=8447b949-37b6-42f0-a754-f0168197c9e4 name=WS-Events-Town owner=e2e-user-1771638290-5769
[GastownUser.do] createTown: created town id=8447b949-37b6-42f0-a754-f0168197c9e4
[gastown-worker] <-- POST /api/users/e2e-user-1771638290-5769/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638290-5769/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638290-5769/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638290-5769 town_id=8447b949-37b6-42f0-a754-f0168197c9e4 name=ws-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=8447b949-37b6-42f0-a754-f0168197c9e4 name=ws-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=79e1268f-c793-4b52-86b9-cbbb37d68da4
[towns.handler] handleCreateRig: rig created id=79e1268f-c793-4b52-86b9-cbbb37d68da4, now configuring Rig DO
[Town.do] configureRig: rigId=79e1268f-c793-4b52-86b9-cbbb37d68da4 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=67b4a97edd7aaa1e825d755d66ff7b2ad1b2a4cf551e1934dd0bfae84b0234e6
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638290-5769/rigs 201 (327ms)
[wrangler:info] POST /api/users/e2e-user-1771638290-5769/rigs 201 Created (328ms)
[gastown-worker] --> POST /api/towns/8447b949-37b6-42f0-a754-f0168197c9e4/mayor/message
[mayor.handler] handleSendMayorMessage: townId=8447b949-37b6-42f0-a754-f0168197c9e4 message="Say hello world in one sentence"
[Town.do] startAgentInContainer: agentId=924794e1-fed5-4b0a-9566-727dc66e8937 role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=d22e87f5-ccba-479e-8ee9-cc13f83e09b7
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=5b548d1839911ea425461c18137a492ec35673a00cde10a3bdf319586dcb205f


Port 8080 is ready
[TownContainer.do] container started for DO id=5b548d1839911ea425461c18137a492ec35673a00cde10a3bdf319586dcb205f
[TownContainer.do] container stopped: exitCode=137 reason=exit id=5b548d1839911ea425461c18137a492ec35673a00cde10a3bdf319586dcb205f
[Town.do] alarm: fired for town=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c


[Town.do] startAgentInContainer: agentId=0fa4c2fa-3d4d-4eee-ab58-9eae5099c010 role=polecat name=Toast
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[gastown-worker] <-- POST /api/towns/8447b949-37b6-42f0-a754-f0168197c9e4/mayor/message 200 (5628ms)
[wrangler:info] POST /api/towns/8447b949-37b6-42f0-a754-f0168197c9e4/mayor/message 200 OK (5629ms)
Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c


[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[Town.do] startAgentInContainer: error response: Failed to start container: The operation was aborted[0m


[Town.do] alarm: fired for town=8447b949-37b6-42f0-a754-f0168197c9e4
[Town.do] alarm: fired for town=5bd7c7ad-98fc-4ea7-9538-04c0bd769a55
Port 8080 is ready
[TownContainer.do] container started for DO id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c
[TownContainer.do] container stopped: exitCode=137 reason=exit id=67034a6e32712d2220e368fb066dd01c3d64bf6db1ac55d43884635406836b7c
[gastown-worker] WS upgrade: townId=8447b949-37b6-42f0-a754-f0168197c9e4 agentId=924794e1-fed5-4b0a-9566-727dc66e8937
[wrangler:info] GET /api/towns/8447b949-37b6-42f0-a754-f0168197c9e4/container/agents/924794e1-fed5-4b0a-9566-727dc66e8937/stream 101 Switching Protocols (11ms)
[Town.do] alarm: fired for town=8447b949-37b6-42f0-a754-f0168197c9e4
[gastown-worker] --> POST /api/users/e2e-user-1771638336-5904/towns
[GastownUser.do] createTown: id=c82ebacd-a2eb-4e2a-a922-15703a51fae4 name=Token-Trace-Town owner=e2e-user-1771638336-5904
[GastownUser.do] createTown: created town id=c82ebacd-a2eb-4e2a-a922-15703a51fae4
[gastown-worker] <-- POST /api/users/e2e-user-1771638336-5904/towns 201 (1ms)
[wrangler:info] POST /api/users/e2e-user-1771638336-5904/towns 201 Created (3ms)
[gastown-worker] --> GET /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/config
[gastown-worker] <-- GET /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/config 200 (1ms)
[wrangler:info] GET /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/config 200 OK (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638336-5904/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638336-5904 town_id=c82ebacd-a2eb-4e2a-a922-15703a51fae4 name=trace-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=c82ebacd-a2eb-4e2a-a922-15703a51fae4 name=trace-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=de579202-69b1-4005-b319-766dfceffc1a
[towns.handler] handleCreateRig: rig created id=de579202-69b1-4005-b319-766dfceffc1a, now configuring Rig DO
[Town.do] configureRig: rigId=de579202-69b1-4005-b319-766dfceffc1a hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=4e19612b6aa30a317991f1be1ad0e39e6c1e76ff06bc4ce19eaa34e771606404
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638336-5904/rigs 201 (326ms)
[wrangler:info] POST /api/users/e2e-user-1771638336-5904/rigs 201 Created (327ms)
[gastown-worker] --> GET /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/config
[gastown-worker] <-- GET /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/config 200 (0ms)
[wrangler:info] GET /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/config 200 OK (1ms)
[gastown-worker] --> POST /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/mayor/message
[mayor.handler] handleSendMayorMessage: townId=c82ebacd-a2eb-4e2a-a922-15703a51fae4 message="Token trace test"
[Town.do] startAgentInContainer: agentId=4a5649f5-6439-4f82-af3e-827c83d893cb role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=8447b949-37b6-42f0-a754-f0168197c9e4
[gastown-worker] <-- POST /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/mayor/message 200 (6153ms)
[wrangler:info] POST /api/towns/c82ebacd-a2eb-4e2a-a922-15703a51fae4/mayor/message 200 OK (6153ms)
[Town.do] alarm: fired for town=c82ebacd-a2eb-4e2a-a922-15703a51fae4
[Town.do] alarm: fired for town=8447b949-37b6-42f0-a754-f0168197c9e4
[TownContainer.do] container stopped: exitCode=137 reason=exit id=4e19612b6aa30a317991f1be1ad0e39e6c1e76ff06bc4ce19eaa34e771606404
[TownContainer.do] container stopped: exitCode=137 reason=exit id=67b4a97edd7aaa1e825d755d66ff7b2ad1b2a4cf551e1934dd0bfae84b0234e6
[gastown-worker] --> POST /api/users/e2e-user-1771638358-20752/towns
[GastownUser.do] createTown: id=079929b8-236c-49e7-a98a-406a24cbaa26 name=Stream-Ticket-Town owner=e2e-user-1771638358-20752
[GastownUser.do] createTown: created town id=079929b8-236c-49e7-a98a-406a24cbaa26
[gastown-worker] <-- POST /api/users/e2e-user-1771638358-20752/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638358-20752/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638358-20752/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638358-20752 town_id=079929b8-236c-49e7-a98a-406a24cbaa26 name=st-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=079929b8-236c-49e7-a98a-406a24cbaa26 name=st-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=5b5c7002-f311-4020-89af-ce12e5e36948
[towns.handler] handleCreateRig: rig created id=5b5c7002-f311-4020-89af-ce12e5e36948, now configuring Rig DO
[Town.do] configureRig: rigId=5b5c7002-f311-4020-89af-ce12e5e36948 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=ae7f1e9cc2cd75dc25f50965075b53386a195e205a627fc79f45c56dfcaccc9f
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638358-20752/rigs 201 (331ms)
[wrangler:info] POST /api/users/e2e-user-1771638358-20752/rigs 201 Created (331ms)
[gastown-worker] --> POST /api/towns/079929b8-236c-49e7-a98a-406a24cbaa26/mayor/message
[mayor.handler] handleSendMayorMessage: townId=079929b8-236c-49e7-a98a-406a24cbaa26 message="Stream ticket test"
[Town.do] startAgentInContainer: agentId=3b63a3c0-c50d-4cca-9133-2fb05db909e7 role=mayor name=mayor
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1mFailed to resolve GASTOWN_JWT_SECRET[0m


[Town.do] alarm: fired for town=c82ebacd-a2eb-4e2a-a922-15703a51fae4
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[gastown-worker] <-- POST /api/towns/079929b8-236c-49e7-a98a-406a24cbaa26/mayor/message 200 (5547ms)
[wrangler:info] POST /api/towns/079929b8-236c-49e7-a98a-406a24cbaa26/mayor/message 200 OK (5549ms)
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=4e19612b6aa30a317991f1be1ad0e39e6c1e76ff06bc4ce19eaa34e771606404


[Town.do] alarm: fired for town=8447b949-37b6-42f0-a754-f0168197c9e4
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: [Error: Container exited with unexpected exit code: 137] {[0m

    exitCode: 137
  } id=67b4a97edd7aaa1e825d755d66ff7b2ad1b2a4cf551e1934dd0bfae84b0234e6


Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=4e19612b6aa30a317991f1be1ad0e39e6c1e76ff06bc4ce19eaa34e771606404


Error checking 8080: The operation was aborted
[31mâœ˜ [41;31m[[41;97mERROR[41;31m][0m [1m[TownContainer.do] container error: Error: Container crashed while checking for ports, did you start the container and setup the entrypoint correctly?[0m

      at TownContainerDO.waitForPort (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:474:15)
      at async TownContainerDO.startAndWaitForPorts (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:415:19)
      at async TownContainerDO.containerFetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:693:9)
      at async TownContainerDO.fetch (file:///Users/john/projects/professional/kilo/cloud/node_modules/.pnpm/@cloudflare+containers@0.1.0/node_modules/@cloudflare/containers/src/lib/container.ts:762:12) id=67b4a97edd7aaa1e825d755d66ff7b2ad1b2a4cf551e1934dd0bfae84b0234e6


[Town.do] alarm: fired for town=079929b8-236c-49e7-a98a-406a24cbaa26
[gastown-worker] --> POST /api/towns/079929b8-236c-49e7-a98a-406a24cbaa26/container/agents/3b63a3c0-c50d-4cca-9133-2fb05db909e7/stream-ticket
[gastown-worker] <-- POST /api/towns/079929b8-236c-49e7-a98a-406a24cbaa26/container/agents/3b63a3c0-c50d-4cca-9133-2fb05db909e7/stream-ticket 200 (8ms)
[wrangler:info] POST /api/towns/079929b8-236c-49e7-a98a-406a24cbaa26/container/agents/3b63a3c0-c50d-4cca-9133-2fb05db909e7/stream-ticket 200 OK (10ms)
[gastown-worker] WS upgrade: townId=079929b8-236c-49e7-a98a-406a24cbaa26 agentId=3b63a3c0-c50d-4cca-9133-2fb05db909e7
[wrangler:info] GET /api/towns/079929b8-236c-49e7-a98a-406a24cbaa26/container/agents/3b63a3c0-c50d-4cca-9133-2fb05db909e7/stream 101 Switching Protocols (9ms)
[Town.do] alarm: fired for town=c82ebacd-a2eb-4e2a-a922-15703a51fae4
Port 8080 is ready
[TownContainer.do] container started for DO id=4e19612b6aa30a317991f1be1ad0e39e6c1e76ff06bc4ce19eaa34e771606404
[TownContainer.do] container stopped: exitCode=137 reason=exit id=4e19612b6aa30a317991f1be1ad0e39e6c1e76ff06bc4ce19eaa34e771606404
[Town.do] alarm: fired for town=8447b949-37b6-42f0-a754-f0168197c9e4
Port 8080 is ready
[TownContainer.do] container started for DO id=67b4a97edd7aaa1e825d755d66ff7b2ad1b2a4cf551e1934dd0bfae84b0234e6
[TownContainer.do] container stopped: exitCode=137 reason=exit id=67b4a97edd7aaa1e825d755d66ff7b2ad1b2a4cf551e1934dd0bfae84b0234e6
[Town.do] alarm: fired for town=079929b8-236c-49e7-a98a-406a24cbaa26
[gastown-worker] --> POST /api/users/e2e-user-1771638393-18161/towns
[GastownUser.do] createTown: id=bbd02063-06ad-4c8b-9cea-ec0ffc70447c name=No-Token-Town owner=e2e-user-1771638393-18161
[GastownUser.do] createTown: created town id=bbd02063-06ad-4c8b-9cea-ec0ffc70447c
[gastown-worker] <-- POST /api/users/e2e-user-1771638393-18161/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638393-18161/towns 201 Created (3ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638393-18161/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638393-18161 town_id=bbd02063-06ad-4c8b-9cea-ec0ffc70447c name=no-token-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=bbd02063-06ad-4c8b-9cea-ec0ffc70447c name=no-token-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=4a50a460-eba0-45fe-a399-82d16506275f
[towns.handler] handleCreateRig: rig created id=4a50a460-eba0-45fe-a399-82d16506275f, now configuring Rig DO
[Town.do] configureRig: rigId=4a50a460-eba0-45fe-a399-82d16506275f hasKilocodeToken=false
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=a4f75ac17092552087f51371f014d96a731e74673008064c2869baaf2c4e9147
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638393-18161/rigs 201 (332ms)
[wrangler:info] POST /api/users/e2e-user-1771638393-18161/rigs 201 Created (334ms)
[gastown-worker] --> GET /api/towns/bbd02063-06ad-4c8b-9cea-ec0ffc70447c/config
[gastown-worker] <-- GET /api/towns/bbd02063-06ad-4c8b-9cea-ec0ffc70447c/config 200 (1ms)
[wrangler:info] GET /api/towns/bbd02063-06ad-4c8b-9cea-ec0ffc70447c/config 200 OK (1ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638394-19921/towns
[GastownUser.do] createTown: id=d4684caa-0090-4fe6-ad14-05319196d497 name=NextJS-Token-Town owner=e2e-user-1771638394-19921
[GastownUser.do] createTown: created town id=d4684caa-0090-4fe6-ad14-05319196d497
[gastown-worker] <-- POST /api/users/e2e-user-1771638394-19921/towns 201 (2ms)
[wrangler:info] POST /api/users/e2e-user-1771638394-19921/towns 201 Created (2ms)
[gastown-worker] --> POST /api/users/e2e-user-1771638394-19921/rigs
[towns.handler] handleCreateRig: userId=e2e-user-1771638394-19921 town_id=d4684caa-0090-4fe6-ad14-05319196d497 name=nextjs-rig git_url=https://github.com/test/repo.git
[GastownUser.do] createRig: town_id=d4684caa-0090-4fe6-ad14-05319196d497 name=nextjs-rig git_url=https://github.com/test/repo.git default_branch=main integration=none
[GastownUser.do] createRig: created rig id=d0032ab1-d960-482f-8929-9e42b38ef803
[towns.handler] handleCreateRig: rig created id=d0032ab1-d960-482f-8929-9e42b38ef803, now configuring Rig DO
[Town.do] configureRig: rigId=d0032ab1-d960-482f-8929-9e42b38ef803 hasKilocodeToken=true
[Town.do] configureRig: propagating kilocodeToken to town config
[Town.do] updateTownConfig: saved config with 0 env vars
[Town.do] configureRig: proactively starting container
Error checking if container is ready: connect(): Connection refused: container port not found. Make sure you exposed the port in your container definition.
Port 8080 is ready
[TownContainer.do] container started for DO id=a5d650cecc4061ec1ba868ec3c682d578179b2b486511e8ba4d25a2981409021
[towns.handler] handleCreateRig: Town DO configured and rig registered
[gastown-worker] <-- POST /api/users/e2e-user-1771638394-19921/rigs 201 (332ms)
[wrangler:info] POST /api/users/e2e-user-1771638394-19921/rigs 201 Created (333ms)
[gastown-worker] --> GET /api/towns/d4684caa-0090-4fe6-ad14-05319196d497/config
[gastown-worker] <-- GET /api/towns/d4684caa-0090-4fe6-ad14-05319196d497/config 200 (0ms)
[wrangler:info] GET /api/towns/d4684caa-0090-4fe6-ad14-05319196d497/config 200 OK (2ms)
[gastown-worker] --> GET /health
[gastown-worker] <-- GET /health 200 (0ms)
[wrangler:info] GET /health 200 OK (1ms)
[Town.do] alarm: fired for town=079929b8-236c-49e7-a98a-406a24cbaa26
[Town.do] alarm: fired for town=bbd02063-06ad-4c8b-9cea-ec0ffc70447c
[Town.do] alarm: fired for town=d4684caa-0090-4fe6-ad14-05319196d497
[Town.do] alarm: fired for town=079929b8-236c-49e7-a98a-406a24cbaa26
ðŸªµ  Logs were written to "/Users/john/Library/Preferences/.wrangler/logs/wrangler-2026-02-21_01-43-04_630.log"
